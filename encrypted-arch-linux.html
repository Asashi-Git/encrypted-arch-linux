<!DOCTYPE html> <html><head>
		<title>ARCH LINUX - Manual Install and Hardening</title>
		<base href="./">
		<meta id="root-path" root-path="./">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Obsidian Vault - ARCH LINUX - Manual Install and Hardening">
		<meta property="og:title" content="ARCH LINUX - Manual Install and Hardening">
		<meta property="og:description" content="Obsidian Vault - ARCH LINUX - Manual Install and Hardening">
		<meta property="og:type" content="website">
		<meta property="og:url" content="arch-linux-manual-install-and-hardening.html">
		<meta property="og:image" content="undefined">
		<meta property="og:site_name" content="Obsidian Vault">
		<meta name="author" content="Samuel Decarnelle"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="lib/scripts/pixi.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="lib/scripts/minisearch.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/supported-plugins.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="ARCH LINUX - Manual Install and Hardening">ARCH LINUX - Manual Install and Hardening</h1><div class="el-hr"><hr></div><div class="el-h2 heading-wrapper"><h2 data-heading="Prerequisites" dir="auto" class="heading" id="Prerequisites"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Prerequisites</h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">
<p>Arch-Linux installation media (ISO file)</p>
</li>
<li data-line="1" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p>Machine with :</p>
<ul>
<li data-line="2" dir="auto">8GB RAM</li>
<li data-line="3" dir="auto">110GB storage</li>
<li data-line="4" dir="auto">Network connectivity</li>
</ul>
<hr>
</li>
</ul></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="Installation Procedure" dir="auto" class="heading" id="Installation_Procedure">Installation Procedure</h1><div class="heading-children"><div class="el-h2 heading-wrapper"><h2 data-heading="Initial Setup" dir="auto" class="heading" id="Initial_Setup"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Initial Setup</h2><div class="heading-children"><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Boot Media</div></div><div class="callout-content">
<p dir="auto">Start your Arch-Linux iso mounted in EFI</p>
</div></div></div><div class="el-p"><p dir="auto">Change your keyboard layout if needed:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">loadkey fr
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3 heading-wrapper"><h3 data-heading="Storage Configuration with Encryption" dir="auto" class="heading" id="Storage_Configuration_with_Encryption"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Storage Configuration with Encryption</h3><div class="heading-children"><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="warning" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Critical with Encryption</div></div><div class="callout-content">
<p dir="auto">The encryption passphrase cannot be recovered if lost. Document it securely but separately from the system.</p>
</div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="View current disk layout:" dir="auto" class="heading" id="View_current_disk_layout:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>View current disk layout:</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">lsblk
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Create partitions" dir="auto" class="heading" id="Create_partitions"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Create partitions</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">cfdisk</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-input" tabindex="0"><code data-line="0" class="language-input is-loaded">/dev/vda1 - EFI partition (~300-512MB)
/dev/vda2 - LUKS container (rest of the disk)
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="important" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto"><code>cfdisk</code> is a curses-based (terminal UI) disk partitioning tool for Linux. It provides an interactive interface to create, delete, resize, and manage partitions on storage devices. It's often preferred over <code>fdisk</code> because it offers a more user-friendly interface while still being terminal-based.</p>
</div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">GPT for EFI: Why It's Required?</div></div><div class="callout-content">
<p dir="auto">GPT (GUID Partition Table) is necessary for EFI/UEFI systems because:</p>
<ul>
<li data-line="2" dir="auto">The UEFI specification officially requires GPT.</li>
<li data-line="3" dir="auto">GPT provides the unique partition type identifiers (GUIDs) that UEFI firmware uses to locate the EFI System Partition.</li>
<li data-line="4" dir="auto">MBR lacks the technical capability to properly identify EFI partitions to the firmware.</li>
<li data-line="5" dir="auto">While some UEFI implementations might boot from MBR in compatibility mode, this is not guaranteed across all hardware and may cause boot issues.</li>
</ul>
<p dir="auto">In short: EFI needs GPT to reliably identify and boot from the correct partition.</p>
</div></div></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Format and encrypt your partition" dir="auto" class="heading" id="Format_and_encrypt_your_partition"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Format and encrypt your partition</h3><div class="heading-children"><div class="el-h6 heading-wrapper"><h6 data-heading="Format your EFI partition" dir="auto" class="heading" id="Format_your_EFI_partition"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Format your EFI partition</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">mkfs.fat <span class="token parameter variable">-F32</span> /dev/vda1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Info</div></div><div class="callout-content">
<p dir="auto"><code>mkfs</code> stands for "make filesystem." It's a crucial command used during the Arch Linux installation process that formats a partition with a specific filesystem type, preparing it to store files and directories.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Encrypt the main partition" dir="auto" class="heading" id="Encrypt_the_main_partition"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Encrypt the main partition</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">cryptsetup luksFormat <span class="token parameter variable">--type</span> luks2 /dev/vda2
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Info</div></div><div class="callout-content">
<p dir="auto"><code>cryptsetup</code> is a utility used to set up disk encryption on Linux systems, particularly for creating, managing, and accessing encrypted disk partitions. <code>luksFormat</code> is a specific command within cryptsetup that initializes a LUKS (Linux Unified Key Setup) encrypted partition, essentially formatting the device with encryption capabilities. This allows you to create secure, password-protected partitions during Arch Linux installation to protect your data from unauthorized access if your physical drive is stolen or compromised.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Open the encrypted container" dir="auto" class="heading" id="Open_the_encrypted_container"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Open the encrypted container</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">cryptsetup <span class="token function">open</span> /dev/vda2 cryptlvm
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Info</div></div><div class="callout-content">
<p dir="auto"><code>cryptsetup open /dev/vda2 cryptlvm</code> means you're unlocking an encrypted LUKS partition (/dev/vda2) and mapping it to a device named "cryptlvm" under /dev/mapper. This command decrypts the partition using your passphrase and makes the unencrypted contents accessible through the device mapper path (/dev/mapper/cryptlvm), allowing you to use this decrypted volume for operations like creating logical volumes or mounting filesystems. After this command, the encrypted contents become accessible to the system while remaining encrypted on the physical disk.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Create a physical volume" dir="auto" class="heading" id="Create_a_physical_volume"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Create a physical volume</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">pvcreate /dev/mapper/cryptlvm
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Info</div></div><div class="callout-content">
<p dir="auto"><code>pvcreate /dev/mapper/cryptlvm</code> means you're initializing a physical volume (PV) for use with Logical Volume Management (LVM) on the decrypted device mapper path (/dev/mapper/cryptlvm). This command prepares the previously unlocked LUKS partition to be used within LVM's storage management system. It writes metadata to the device, marking it as an LVM physical volume, which is the foundation layer of the LVM structure. Once initialized, this physical volume can be added to volume groups and subsequently divided into logical volumes for flexible storage management.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Create a volume group (vg0)" dir="auto" class="heading" id="Create_a_volume_group_(vg0)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Create a volume group (vg0)</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">vgcreate vg0 /dev/mapper/cryptlvm
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Info</div></div><div class="callout-content">
<p dir="auto"><code>vgcreate vg0 /dev/mapper/cryptlvm</code> means you're creating a new volume group named "vg0" using the previously initialized physical volume at /dev/mapper/cryptlvm. This command sets up the middle layer of the LVM hierarchy. A volume group acts as a pool of storage that combines one or more physical volumes (in this case, just your encrypted partition) into a single administrative unit. Once created, the volume group "vg0" becomes the container from which you can carve out logical volumes of various sizes for different purposes like root filesystem, home directory, or swap space, regardless of the physical disk boundaries.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Create logical volumes for each partition" dir="auto" class="heading" id="Create_logical_volumes_for_each_partition"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Create logical volumes for each partition</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">lvcreate <span class="token parameter variable">-L</span> 20G vg0 <span class="token parameter variable">-n</span> root     <span class="token comment"># Adjust size as needed</span>
lvcreate <span class="token parameter variable">-L</span> 15G vg0 <span class="token parameter variable">-n</span> var      <span class="token comment"># Adjust size as needed</span>
lvcreate <span class="token parameter variable">-L</span> 20G vg0 <span class="token parameter variable">-n</span> usr      <span class="token comment"># Adjust size as needed</span>
lvcreate <span class="token parameter variable">-L</span> 10G vg0 <span class="token parameter variable">-n</span> data     <span class="token comment"># Adjust size as needed</span>
lvcreate <span class="token parameter variable">-L</span> 30G vg0 <span class="token parameter variable">-n</span> home     <span class="token comment"># Adjust size as needed</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Optional: create a swap partition if needed" dir="auto" class="heading" id="Optional:_create_a_swap_partition_if_needed"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Optional: create a swap partition if needed</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">lvcreate <span class="token parameter variable">-L</span> 8G vg0 <span class="token parameter variable">-n</span> swap      <span class="token comment"># Adjust size as needed</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Info</div></div><div class="callout-content">
<p dir="auto">Each command allocates a specific amount of space from the volume group and creates a logical device that can be formatted with a filesystem. These logical volumes will be accessible at paths like /dev/vg0/root, /dev/vg0/home, etc.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Format the partitions" dir="auto" class="heading" id="Format_the_partitions"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Format the partitions</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">mkfs.ext4 /dev/vg0/root
mkfs.ext4 /dev/vg0/var
mkfs.ext4 /dev/vg0/usr
mkfs.ext4 /dev/vg0/data
mkfs.ext4 /dev/vg0/home
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="important" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">The ext4 filesystem is a common choice for Linux systems as it provides a good balance of performance, features, and reliability. Running these commands effectively initializes each logical volume with a fresh filesystem, destroying any existing data on them and creating the necessary structures (like inodes, journal, and superblocks) for the operating system to store and retrieve files. After formatting, these filesystems are ready to be mounted and used for their respective purposes in your Arch Linux system.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="If you created a swap partition" dir="auto" class="heading" id="If_you_created_a_swap_partition"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>If you created a swap partition</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">mkswap</span> /dev/vg0/swap
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="done" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">Initial Setup, Encryption and Format Done!</div></div></div></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Mount your partitions" dir="auto" class="heading" id="Mount_your_partitions"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Mount your partitions</h3><div class="heading-children"><div class="el-h6 heading-wrapper"><h6 data-heading="Mount the root filesystem" dir="auto" class="heading" id="Mount_the_root_filesystem"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Mount the root filesystem</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">mount</span> /dev/vg0/root /mnt
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Info</div></div><div class="callout-content">
<p dir="auto">This step is crucial because it makes the newly created filesystem available for operations like extracting the base system, chrooting into it for configuration, and installing packages. The root filesystem is mounted first since it will contain the directory structure where other filesystems will be mounted.</p>
</div></div></div></div></div><div class="el-h5 heading-wrapper"><h5 data-heading="Create directories for other mount points" dir="auto" class="heading" id="Create_directories_for_other_mount_points"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Create directories for other mount points</h5><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /mnt/<span class="token punctuation">{</span>boot,home,var,usr,data<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h6 heading-wrapper"><h6 data-heading="Mount the boot partition" dir="auto" class="heading" id="Mount_the_boot_partition"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Mount the boot partition</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">mount</span> /dev/vda1 /mnt/boot
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Info</div></div><div class="callout-content">
<p dir="auto">This step is essential because the boot partition needs to be accessible to install and configure the bootloader (like GRUB or systemd-boot), which will allow your system to boot properly after installation is complete. Without this mount, your bootloader wouldn't be able to find the necessary boot files when your system starts.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Mount other partitions" dir="auto" class="heading" id="Mount_other_partitions"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Mount other partitions</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">mount</span> /dev/vg0/home /mnt/home
<span class="token function">mount</span> /dev/vg0/var /mnt/var
<span class="token function">mount</span> /dev/vg0/usr /mnt/usr
<span class="token function">mount</span> /dev/vg0/data /mnt/data
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="If you created a swap partition" dir="auto" class="heading" id="If_you_created_a_swap_partition"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>If you created a swap partition</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">swapon</span> /dev/vg0/swap
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="important" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">Since we already created the swap partition, the system will automatically swapon this partition, but doing it can be considered a good practice!</p>
</div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="done" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">Mounted Partition Done!</div></div></div></div></div></div></div></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="!!! HARDENING PARTITION OPTIONS !!!" dir="auto" class="heading" id="!!!_HARDENING_PARTITION_OPTIONS_!!!"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>!!! HARDENING PARTITION OPTIONS !!!</h2><div class="heading-children"><div class="el-p"><p dir="auto">You can put some options for your partitions, either by creating them when you are mounting them or after the reboot of your system. In this section we will see the first method of doing it.</p></div><div class="el-h3 heading-wrapper"><h3 data-heading="When mounting the partition" dir="auto" class="heading" id="When_mounting_the_partition"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>When mounting the partition</h3><div class="heading-children"><div class="el-h6 heading-wrapper"><h6 data-heading="Mount the boot partition with options" dir="auto" class="heading" id="Mount_the_boot_partition_with_options"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Mount the boot partition with options</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">mount</span> /dev/vda1 /mnt/boot <span class="token parameter variable">-o</span> nosuid,nodev,noexec
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Mount other partitions with options" dir="auto" class="heading" id="Mount_other_partitions_with_options"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Mount other partitions with options</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">mount</span> /dev/vg0/home /mnt/home <span class="token parameter variable">-o</span> nosuid,nodev,noexec
<span class="token function">mount</span> /dev/vg0/var /mnt/var <span class="token parameter variable">-o</span> nosuid,nodev,noexec
<span class="token function">mount</span> /dev/vg0/usr /mnt/usr <span class="token parameter variable">-o</span> nodev
<span class="token function">mount</span> /dev/vg0/data /mnt/data
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Install base packages" dir="auto" class="heading" id="Install_base_packages"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Install base packages</h2><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">pacstrap /mnt base base-devel <span class="token function">nano</span> <span class="token function">vim</span> networkmanager lvm2 cryptsetup grub efibootmgr linux linux-firmware sof-firmware
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h6 heading-wrapper"><h6 data-heading="check the fstab config" dir="auto" class="heading" id="check_the_fstab_config"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>check the fstab config</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">genfstab <span class="token parameter variable">-U</span> /mnt
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="if all look good you can put it in the fstab of your system" dir="auto" class="heading" id="if_all_look_good_you_can_put_it_in_the_fstab_of_your_system"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>if all look good you can put it in the fstab of your system</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">genfstab <span class="token parameter variable">-U</span> /mnt <span class="token operator">&gt;</span> /mnt/etc/fstab 
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="done" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">Now if you cat the /mnt/etc/sftab you sould see your fstab config</div></div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="important" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">The Options are useful to secure more our system:</p>
<p dir="auto">Nosuid <strong>Prevents Set-User-ID and Set-Group-ID Bits from Taking Effect</strong></p>
<ul>
<li data-line="4" dir="auto"><strong>What it does</strong>: Disables the SUID (Set User ID) and SGID (Set Group ID) bits on executables located on that partition.</li>
<li data-line="5" dir="auto"><strong>Normal behavior without this option</strong>: Binaries with SUID/SGID bits can execute with the privileges of the file owner/group rather than the user who runs them.</li>
<li data-line="6" dir="auto"><strong>Security benefit</strong>: Prevents privilege escalation attacks where a malicious executable with SUID bit could gain root access.</li>
<li data-line="7" dir="auto"><strong>Real-world example</strong>: If an attacker places a SUID root binary in /home, it would normally allow any user to run commands as root. With <code>nosuid</code>, this attack vector is eliminated.</li>
</ul>
<p dir="auto">Noexec <strong>Prevents Direct Execution of Binaries</strong></p>
<ul>
<li data-line="10" dir="auto"><strong>What it does</strong>: Blocks the execution of any binaries or scripts located on the partition.</li>
<li data-line="11" dir="auto"><strong>Normal behavior without this option</strong>: Users can run executable files directly from the partition.</li>
<li data-line="12" dir="auto"><strong>Security benefit</strong>: Prevents attackers from executing malicious code they've managed to place on the partition.</li>
<li data-line="13" dir="auto"><strong>Real-world example</strong>: If attackers upload a malicious shell script to your web server's upload directory, <code>noexec</code> would prevent them from directly executing it</li>
</ul>
<p dir="auto">Nodev <strong>Prevents Interpretation of Device Files</strong></p>
<ul>
<li data-line="16" dir="auto"><strong>What it does</strong>: Prevents the interpretation of character or block special device files on the filesystem.</li>
<li data-line="17" dir="auto"><strong>Normal behavior without this option</strong>: Device files could be used to access hardware directly.</li>
<li data-line="18" dir="auto"><strong>Security benefit</strong>: Blocks unauthorized direct access to hardware devices.</li>
<li data-line="19" dir="auto"><strong>Real-world example</strong>: Prevents an attacker from creating a device file that might provide unauthorized access to disk partitions or memory.</li>
</ul>
</div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="done" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">Partition Option Done!</div></div></div></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Then go to your system" dir="auto" class="heading" id="Then_go_to_your_system"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Then go to your system</h2><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">arch-chroot /mnt
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3 heading-wrapper"><h3 data-heading="Configure mkinitcpio.conf to include the necessary hooks" dir="auto" class="heading" id="Configure_mkinitcpio.conf_to_include_the_necessary_hooks"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Configure mkinitcpio.conf to include the necessary hooks</h3><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">vim</span> /etc/mkinitcpio.conf
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre><code data-line="0">-&gt;In mkinitcpio.conf, make sure your HOOKS line includes encrypt and lvm2 before filesystems and usr at the end:
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-input" tabindex="0"><code data-line="0" class="language-input is-loaded">HOOKS=(base udev autodetect microcode modconf kms keyboard keymap consolefont block encrypt lvm2 filesystems fsck usr)
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h6 heading-wrapper"><h6 data-heading="Then regenerate the initramfs:" dir="auto" class="heading" id="Then_regenerate_the_initramfs:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Then regenerate the initramfs:</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">mkinitcpio <span class="token parameter variable">-P</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="important" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">What's going on when you do mkinitcpio -P?<br>
The system will create all the necessary link to allow it to boot correctly.<br>
Per example if you don't put usr to the end of the HOOKS section, the usr partition that is a different partition will not be linked at the boot. And then good luck, you are on your own ! ;)</p>
</div></div></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Configure your system" dir="auto" class="heading" id="Configure_your_system"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Configure your system</h3><div class="heading-children"><div class="el-h6 heading-wrapper"><h6 data-heading="Set the timezone" dir="auto" class="heading" id="Set_the_timezone"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Set the timezone</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">ln</span> <span class="token parameter variable">-sf</span> /usr/share/zoneinfo/Europe/Paris /etc/localtime
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Sync the hardware clock" dir="auto" class="heading" id="Sync_the_hardware_clock"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Sync the hardware clock</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">hwclock <span class="token parameter variable">--systohc</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre><code data-line="0">-&gt;If you want to check you can:
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">date</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">if the date is correct, all good my friend.</p></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="important" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto"><strong>Hardware clock</strong>: Physical clock on your motherboard powered by a battery, which keeps time even when your computer is powered off<br>
But why is needed ?</p>
<p dir="auto">For example:<br>
Modern file systems like ext4 rely on accurate timestamps. If the system time jumps backward during boot (because of an incorrect hardware clock), this can cause issues with:</p>
<ul>
<li data-line="6" dir="auto">File modification timestamps</li>
<li data-line="7" dir="auto">Journal entries</li>
<li data-line="8" dir="auto">Package management operations</li>
</ul>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Then we need to change the local" dir="auto" class="heading" id="Then_we_need_to_change_the_local"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Then we need to change the local</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">vim</span> /etc/locale.gen
<span class="token comment">#Uncomment your locale (for us fr_FR.UTF-8 UTF-8)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="important" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">You can do: echo "fr_FR.UTF-8 UTF-8" &gt;&gt; /etc/locale.gen</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Now we can generate the locale" dir="auto" class="heading" id="Now_we_can_generate_the_locale"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Now we can generate the locale</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">locale-gen
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="We need to generate the locale in locale.conf too because some application can look there instead" dir="auto" class="heading" id="We_need_to_generate_the_locale_in_locale.conf_too_because_some_application_can_look_there_instead"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>We need to generate the locale in locale.conf too because some application can look there instead</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token builtin class-name">echo</span> <span class="token string">"LANG=fr_FR.UTF-8"</span> <span class="token operator">&gt;&gt;</span> /etc/locale.conf
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="important" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">You can check if it there by typing: cat /etc/locale.conf it sould return: LANG=fr_FR.UTF-8</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Then we need to give our machine an awesome host-name" dir="auto" class="heading" id="Then_we_need_to_give_our_machine_an_awesome_host-name"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Then we need to give our machine an awesome host-name</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token builtin class-name">echo</span> web-server <span class="token operator">&gt;&gt;</span> /etc/hostname <span class="token comment">#WOW AWESOME!</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Set the password for the root user" dir="auto" class="heading" id="Set_the_password_for_the_root_user"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Set the password for the root user</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">passwd</span>
<span class="token comment">#Then type it</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Now we can add a user, in our case localadm" dir="auto" class="heading" id="Now_we_can_add_a_user,_in_our_case_localadm"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Now we can add a user, in our case localadm</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">useradd</span> <span class="token parameter variable">-m</span> <span class="token parameter variable">-G</span> wheel <span class="token parameter variable">-s</span> /bin/bash localadm
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="important" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">-m Create a home directory for the user.<br>
-G Add to a group the user, here group wheel.<br>
-s Set the user default login shell.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Add a password to our new user" dir="auto" class="heading" id="Add_a_password_to_our_new_user"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Add a password to our new user</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">passwd</span> localadm
<span class="token comment">#Then type it</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Then we can edit the visudo file" dir="auto" class="heading" id="Then_we_can_edit_the_visudo_file"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Then we can edit the visudo file</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">visudo
<span class="token comment">#Add localadm ALL(ALL:ALL) ALL under root.</span>
<span class="token comment">#Uncomment the %wheel ALL=(ALL:ALL) ALL.</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="done" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">Basic Setup Done!</div></div></div></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Now we will install grub to our system" dir="auto" class="heading" id="Now_we_will_install_grub_to_our_system"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Now we will install grub to our system</h3><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">grub-install --efi-directory<span class="token operator">=</span>/boot --bootloader-id<span class="token operator">=</span>GRUB /dev/vda
<span class="token comment">#Use the disk you have you boot onto, not the partition, just the disk</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Info</div></div><div class="callout-content">
<p dir="auto">Now if you wan to check, you should: ls /boot<br>
it should return EFI, grub, ...</p>
</div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Now we need to change the grub config to allow grub to boot with encrypted device" dir="auto" class="heading" id="Now_we_need_to_change_the_grub_config_to_allow_grub_to_boot_with_encrypted_device"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Now we need to change the grub config to allow grub to boot with encrypted device</h4><div class="heading-children"><div class="el-p"><p dir="auto">For that we will need the UUID of the encrypted partition (vda2) and the path to the non encrypted one (cryptlvm) to be inside the /etc/default/grub config file</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">blkid <span class="token parameter variable">-o</span> value <span class="token parameter variable">-s</span> UUID /dev/vda2 <span class="token operator">&gt;&gt;</span> /etc/default/grub
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="important" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">What's an UUID?<br>
A UUID (Universally Unique Identifier), also known as a GUID (Globally Unique Identifier), is a 128-bit number used to uniquely identify information in computer systems. A standard UUID appears as a 36-character string (including hyphens "-") with this format:<br>
<code>550e8400-e29b-41d4-a716-446655440000</code></p>
</div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Then we need to go to the config file and put it to the right place" dir="auto" class="heading" id="Then_we_need_to_go_to_the_config_file_and_put_it_to_the_right_place"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Then we need to go to the config file and put it to the right place</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">vim</span> /etc/default/grub
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Here you need to put your encrypted device and your non encrypted device inside the GRUB_CMDLINE_LINUX_DEFAULT line. So it should look like that:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token assign-left variable">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="token operator">=</span><span class="token string">"loglevel=3 quiet cryptdevice=UUID=YourEncryptedDeviceUUID root=/dev/vg0/root"</span> 
<span class="token comment">#Don't forget to delete the UUID at the botom of the file</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="important" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">Why did we did that?<br>
Simply to tell grub what's the encrypted device/partition and when the user enter the passphrase, where he need to boot!</p>
</div></div></div></div></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Finally we can generate the GRUB configuration file" dir="auto" class="heading" id="Finally_we_can_generate_the_GRUB_configuration_file"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Finally we can generate the GRUB configuration file</h4><div class="heading-children"><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="attention" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Attention</div></div><div class="callout-content">
<p dir="auto">This can be considered, the most crucial moment of our configuration. I <strong>highly recommend</strong>, if you are onto a VM, to do a <strong>Snapshot</strong>. If your are not onto a VM, I have <em>respect</em> for you !  &lt;3</p>
</div></div></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">grub-mkconfig</span> <span class="token parameter variable">-o</span> /boot/grub/grub.cfg
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h6 heading-wrapper"><h6 data-heading="Then we can do a QOL by enableling the networkmanager to have an ip add on boot" dir="auto" class="heading" id="Then_we_can_do_a_QOL_by_enableling_the_networkmanager_to_have_an_ip_add_on_boot"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Then we can do a QOL by enableling the networkmanager to have an ip add on boot</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">systemctl <span class="token builtin class-name">enable</span> NetworkManager
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="done" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">Grub Done! GG!!</div></div></div></div></div></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Finally we can umount all and reboot our system" dir="auto" class="heading" id="Finally_we_can_umount_all_and_reboot_our_system"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Finally we can umount all and reboot our system</h3><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token builtin class-name">exit</span>
<span class="token function">umount</span> <span class="token parameter variable">-a</span>
<span class="token function">reboot</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="!!!HARDENING PARTITION OPTIONS!!!" dir="auto" class="heading" id="!!!HARDENING_PARTITION_OPTIONS!!!"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>!!!HARDENING PARTITION OPTIONS!!!</h2><div class="heading-children"><div class="el-p"><p dir="auto">You can put some options for your partitions, either by creating them when you are mounting them or after the reboot of your system.</p></div><div class="el-h3 heading-wrapper"><h3 data-heading="IF NOT DONE BEFORE, YOU CAN DO IT AFTER THE REBOOT OF YOUR SYSTEM" dir="auto" class="heading" id="IF_NOT_DONE_BEFORE,_YOU_CAN_DO_IT_AFTER_THE_REBOOT_OF_YOUR_SYSTEM"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>IF NOT DONE BEFORE, YOU CAN DO IT AFTER THE REBOOT OF YOUR SYSTEM</h3><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">vim</span> /etc/fstab
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-output" tabindex="0"><code data-line="0" class="language-output is-loaded">#Actually It should look like that:
/dev/mapper/vg0-home /home ext4 defaults 0 2
/dev/mapper/vg0-var  /var  ext4 defaults 0 2
/dev/vda1            /boot vfat defaults 0 2
/dev/mapper/vg0-usr  /usr  ext4 defaults 0 2
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-input" tabindex="0"><code data-line="0" class="language-input is-loaded">#Make it like that:
/dev/mapper/vg0-home /home ext4 defaults,nosuid,nodev,noexec 0 2
/dev/mapper/vg0-var  /var  ext4 defaults,nosuid,nodev,noexec 0 2
/dev/vda1            /boot vfat defaults,nosuid,nodev,noexec 0 2
/dev/mapper/vg0-usr  /usr  ext4 defaults,nodev 0 2

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="important" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">The Options are useful to secure more our system:</p>
<p dir="auto">Nosuid <strong>Prevents Set-User-ID and Set-Group-ID Bits from Taking Effect</strong></p>
<ul>
<li data-line="4" dir="auto"><strong>What it does</strong>: Disables the SUID (Set User ID) and SGID (Set Group ID) bits on executables located on that partition.</li>
<li data-line="5" dir="auto"><strong>Normal behavior without this option</strong>: Binaries with SUID/SGID bits can execute with the privileges of the file owner/group rather than the user who runs them.</li>
<li data-line="6" dir="auto"><strong>Security benefit</strong>: Prevents privilege escalation attacks where a malicious executable with SUID bit could gain root access.</li>
<li data-line="7" dir="auto"><strong>Real-world example</strong>: If an attacker places a SUID root binary in /home, it would normally allow any user to run commands as root. With <code>nosuid</code>, this attack vector is eliminated.</li>
</ul>
<p dir="auto">Noexec <strong>Prevents Direct Execution of Binaries</strong></p>
<ul>
<li data-line="10" dir="auto"><strong>What it does</strong>: Blocks the execution of any binaries or scripts located on the partition.</li>
<li data-line="11" dir="auto"><strong>Normal behavior without this option</strong>: Users can run executable files directly from the partition.</li>
<li data-line="12" dir="auto"><strong>Security benefit</strong>: Prevents attackers from executing malicious code they've managed to place on the partition.</li>
<li data-line="13" dir="auto"><strong>Real-world example</strong>: If attackers upload a malicious shell script to your web server's upload directory, <code>noexec</code> would prevent them from directly executing it</li>
</ul>
<p dir="auto">Nodev <strong>Prevents Interpretation of Device Files</strong></p>
<ul>
<li data-line="16" dir="auto"><strong>What it does</strong>: Prevents the interpretation of character or block special device files on the filesystem.</li>
<li data-line="17" dir="auto"><strong>Normal behavior without this option</strong>: Device files could be used to access hardware directly.</li>
<li data-line="18" dir="auto"><strong>Security benefit</strong>: Blocks unauthorized direct access to hardware devices.</li>
<li data-line="19" dir="auto"><strong>Real-world example</strong>: Prevents an attacker from creating a device file that might provide unauthorized access to disk partitions or memory.</li>
</ul>
</div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Then you can reboot to apply the change !" dir="auto" class="heading" id="Then_you_can_reboot_to_apply_the_change_!"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Then you can reboot to apply the change !</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> <span class="token function">reboot</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Hardening the System" dir="auto" class="heading" id="Hardening_the_System"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Hardening the System</h2><div class="heading-children"><div class="el-p"><p dir="auto">Now we need to do some basic good practice to harden our system</p></div><div class="el-h4 heading-wrapper"><h4 data-heading="Configure Logs for Sudo" dir="auto" class="heading" id="Configure_Logs_for_Sudo"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Configure Logs for Sudo</h4><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/sudoers
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-input" tabindex="0"><code data-line="0" class="language-input is-loaded">#Add this line in the default sections of the file
Defaults logfile=/var/log/sudo.log
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Disable the Root User" dir="auto" class="heading" id="Disable_the_Root_User"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Disable the Root User</h4><div class="heading-children"><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="important" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">Why Disabling the Root User Is a Security Best Practice??</p>
<ol>
<li data-line="3" dir="auto"><strong>Prevents Brute Force Attacks on the Most Powerful Account.</strong></li>
</ol>
<p dir="auto">-The root account is a known, high-value target that exists on all Linux systems.<br>
-Attackers often focus brute force attempts on the root account.<br>
-Disabling direct root login eliminates this predictable attack vector.</p>
<ol start="2">
<li data-line="9" dir="auto"><strong>Enforces the Principle of Least Privilege.</strong></li>
</ol>
<p dir="auto">-Standard users have limited access by default.<br>
-Privileged operations require explicit elevation (via sudo/su).<br>
-This prevents accidental execution of dangerous commands.<br>
-Limits potential damage from compromised user sessions.</p>
<ol start="3">
<li data-line="16" dir="auto"><strong>Improves Accountability and Auditing.</strong></li>
</ol>
<p dir="auto">-When using sudo, each privileged command is logged with the original user's identity.<br>
-This creates a clear audit trail of who performed what administrative action.<br>
-With direct root login, you lose the ability to track which actual person executed commands.</p>
<ol start="4">
<li data-line="22" dir="auto"><strong>Reduces the Impact of Human Error.</strong></li>
</ol>
<p dir="auto">-The extra step of using sudo adds a moment of consideration before executing powerful commands.<br>
-Helps prevent catastrophic mistakes (e.g., <code>rm -rf /</code> run accidentally).<br>
-Many dangerous commands prompt for confirmation when run via sudo.</p>
<ol start="5">
<li data-line="28" dir="auto"><strong>Limits Exposure from Compromise.</strong></li>
</ol>
<p dir="auto">-If an attacker compromises a standard user account, they still need to find a way to escalate privileges.<br>
-This creates an additional security layer the attacker must overcome.<br>
-Even when a user has sudo rights, the attacker needs to know/crack that user's password.</p>
<ol start="6">
<li data-line="34" dir="auto"><strong>Facilitates Secure Remote Access Policies.</strong></li>
</ol>
<p dir="auto">-SSH can be configured to deny root login entirely.<br>
-Forces attackers to compromise both a standard user account AND a method to escalate privileges.<br>
-Allows security tools to monitor for suspicious privilege escalation attempts.</p>
</div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="edit /etc/passwd" dir="auto" class="heading" id="edit_/etc/passwd"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>edit /etc/passwd</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/passwd
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Find the <code>root</code> line and change the shell to <code>/usr/sbin/nologin</code> :</p></div><div class="el-pre"><pre class="language-input" tabindex="0"><code data-line="0" class="language-input is-loaded">root:x:0:0:root:/root:/usr/sbin/nologin
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Edit `/etc/shadow` :" dir="auto" class="heading" id="Edit_`/etc/shadow`_:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Edit <code>/etc/shadow</code> :</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/shadow
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Lock the root password by replacing <code>*</code> by <code>!</code> :</p></div><div class="el-pre"><pre class="language-input" tabindex="0"><code data-line="0" class="language-input is-loaded">root:!:19977:0:99999:7:::
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Add Security Options" dir="auto" class="heading" id="Add_Security_Options"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Add Security Options</h4><div class="heading-children"><div class="el-h6 heading-wrapper"><h6 data-heading="Edit /etc/fstab" dir="auto" class="heading" id="Edit_/etc/fstab"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Edit /etc/fstab</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/fstab
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">ADD theses two line at the end of the file :</p></div><div class="el-pre"><pre class="language-input" tabindex="0"><code data-line="0" class="language-input is-loaded">#proc
proc           /proc            proc            hidepid=2 0 0

#tmpfs
tmpfs          /tmp             tmpfs           nosuid,nodev,noexec 0 0
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="done" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">Base Hardening Done!</div></div></div></div><div class="el-hr"><hr></div></div></div></div></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="SSH Server: Setup, Configuration and Hardening" dir="auto" class="heading" id="SSH_Server:_Setup,_Configuration_and_Hardening">SSH Server: Setup, Configuration and Hardening</h1><div class="heading-children"><div class="el-p"><p dir="auto">Instead of using passwords to log in to your server, SSH keys provide enhanced security. This system works through a matched pair of keys:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Your server holds the public key</li>
<li data-line="1" dir="auto">You keep the private key secure on your computer</li>
</ul></div><div class="el-p"><p dir="auto">When connecting, your server verifies your identity by checking if your private key matches the stored public key - no password needed. This prevents unauthorized access even if someone attempts password-guessing attacks.</p></div><div class="el-h2 heading-wrapper"><h2 data-heading="Basic Setup" dir="auto" class="heading" id="Basic_Setup"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Basic Setup</h2><div class="heading-children"><div class="el-h3 heading-wrapper"><h3 data-heading="Install Required Packages" dir="auto" class="heading" id="Install_Required_Packages"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Install Required Packages</h3><div class="heading-children"><div class="el-p"><p dir="auto">First, update your system and install the necessary packages :</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> openssh libpam-google-authenticator qrencode
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Configure SSH Service" dir="auto" class="heading" id="Configure_SSH_Service"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Configure SSH Service</h3><div class="heading-children"><div class="el-p"><p dir="auto">Start and enable the SSH service to ensure it runs at system boot :</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> sshd
<span class="token function">sudo</span> systemctl start sshd
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Hardening SSH Configuration" dir="auto" class="heading" id="Hardening_SSH_Configuration"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Hardening SSH Configuration</h2><div class="heading-children"><div class="el-h3 heading-wrapper"><h3 data-heading="Modify SSH Port" dir="auto" class="heading" id="Modify_SSH_Port"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Modify SSH Port</h3><div class="heading-children"><div class="el-p"><p dir="auto">Changing the default SSH port helps reduce automated attack attempts.</p></div><div class="el-p"><p dir="auto">Edit the SSH configuration file :</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/ssh/sshd_config
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Find the <code>Port</code> line and modify it (uncomment if necessary) :</p></div><div class="el-pre"><pre class="language-vim" tabindex="0"><code data-line="0" class="language-vim is-loaded">Port <span class="token operator">&lt;</span>port<span class="token operator">&gt;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="tip" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Security Note :</div></div><div class="callout-content">
<p dir="auto">Choose a port number between <code>1024</code> and <code>65535</code> that isn't used by other services. </p>
</div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Disable Root Login" dir="auto" class="heading" id="Disable_Root_Login"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Disable Root Login</h3><div class="heading-children"><div class="el-p"><p dir="auto">Preventing direct root login via SSH is a critical security measure.</p></div><div class="el-p"><p dir="auto">In <code>/etc/ssh/sshd_config</code>, find and modify :</p></div><div class="el-pre"><pre class="language-vim" tabindex="0"><code data-line="0" class="language-vim is-loaded">PermitRootLogin no
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Apply Changes" dir="auto" class="heading" id="Apply_Changes"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Apply Changes</h3><div class="heading-children"><div class="el-p"><p dir="auto">Restart the SSH service to apply all changes :</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> systemctl restart sshd
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Connect to SSH" dir="auto" class="heading" id="Connect_to_SSH"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Connect to SSH</h3><div class="heading-children"><div class="el-p"><p dir="auto">On client machine :</p></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded">ssh <span class="token operator">-</span>p &lt;port&gt; &lt;username&gt;@&lt;server-ip&gt;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="done" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">Basic SSH Config Done!</div></div></div></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="RSA Key Authentication" dir="auto" class="heading" id="RSA_Key_Authentication"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>RSA Key Authentication</h2><div class="heading-children"><div class="el-h3 heading-wrapper"><h3 data-heading="Generate SSH Key Pair on Server" dir="auto" class="heading" id="Generate_SSH_Key_Pair_on_Server"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Generate SSH Key Pair on Server</h3><div class="heading-children"><div class="el-p"><p dir="auto">On your server machine (not the client) generate an RSA key pair :</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">ssh-keygen <span class="token parameter variable">-t</span> rsa <span class="token parameter variable">-b</span> <span class="token number">4096</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Then, add the public key to <code>authorized_keys</code> :</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">cat</span> ~/.ssh/id_rsa.pub <span class="token operator">&gt;&gt;</span> ~/.ssh/authorized_keys
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Transfer Private Key to Client" dir="auto" class="heading" id="Transfer_Private_Key_to_Client"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Transfer Private Key to Client</h3><div class="heading-children"><div class="el-p"><p dir="auto">Copy your private key to the client :</p></div><div class="el-p"><p dir="auto">Windows (with PowerShell):</p></div><div class="el-pre"><pre class="language-powershell" tabindex="0"><code data-line="0" class="language-powershell is-loaded">scp <span class="token operator">-</span>P &lt;port&gt; &lt;username&gt;@&lt;server-ip&gt;:~<span class="token operator">/</span><span class="token punctuation">.</span>ssh/id_rsa <span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span>ssh
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Enable Authorized Keys File" dir="auto" class="heading" id="Enable_Authorized_Keys_File"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Enable Authorized Keys File</h3><div class="heading-children"><div class="el-p"><p dir="auto">In <code>/etc/ssh/sshd_config</code>, find and uncheck :</p></div><div class="el-pre"><pre class="language-vim" tabindex="0"><code data-line="0" class="language-vim is-loaded">AuthorizedKeysFile <span class="token operator">.</span>ssh<span class="token operator">/</span>authorized_keys
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Apply Changes" dir="auto" class="heading" id="Apply_Changes"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Apply Changes</h3><div class="heading-children"><div class="el-p"><p dir="auto">Restart the SSH service to apply all changes :</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> systemctl restart sshd
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="attention" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Important :</div></div><div class="callout-content">
<p dir="auto">Do not close your current SSH session until youve verified the new configuration works.</p>
</div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="done" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">RSA Config Done!</div></div></div></div><div class="el-hr"><hr></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Two-Factor Authentication (2FA)" dir="auto" class="heading" id="Two-Factor_Authentication_(2FA)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Two-Factor Authentication (2FA)</h2><div class="heading-children"><div class="el-h3 heading-wrapper"><h3 data-heading="Install and Configure Google Authenticator" dir="auto" class="heading" id="Install_and_Configure_Google_Authenticator"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Install and Configure Google Authenticator</h3><div class="heading-children"><div class="el-h4 heading-wrapper"><h4 data-heading="Set up correct time zone" dir="auto" class="heading" id="Set_up_correct_time_zone"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Set up correct time zone</h4><div class="heading-children"><div class="el-h6 heading-wrapper"><h6 data-heading="Check your date" dir="auto" class="heading" id="Check_your_date"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Check your date</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">date</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="If it's the good date and hour, you can proceed, else you need to set the good time/date:" dir="auto" class="heading" id="If_it's_the_good_date_and_hour,_you_can_proceed,_else_you_need_to_set_the_good_time/date:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>If it's the good date and hour, you can proceed, else you need to set the good time/date:</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> timedatectl set-timezone <span class="token operator">&lt;</span>continent<span class="token operator">&gt;</span>/<span class="token operator">&lt;</span>capital<span class="token operator">&gt;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">On the server, run the configuration tool :</li>
</ol></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">	google-authenticator	
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-ol"><ol start="2">
<li data-line="0" dir="auto">A QR code will be displayed in the terminal. Scan it with an authenticator app like Google Authenticator, Authy, or Microsoft Authenticator.</li>
<li data-line="1" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Answer the questions when prompted :
<ul>
<li data-line="2" dir="auto"><code>"Do you want authentication tokens to be time-based?"</code>  <code>y</code> (Uses time-based OTP tokens)</li>
<li data-line="3" dir="auto"><code>"Do you want to disallow multiple uses...?"</code>  <code>y</code> (Prevents replay attacks)</li>
<li data-line="4" dir="auto"><code>"Do you want to increase the original window...?"</code>  <code>n</code> (Maintains tight time synchronization requirements)</li>
<li data-line="5" dir="auto"><code>"Do you want to enable rate-limiting?"</code>  <code>y</code> (Prevents brute force attacks)</li>
</ul>
</li>
<li data-line="6" dir="auto">Save the emergency scratch codes in a secure location.</li>
</ol></div></div></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Configure PAM for SSH 2FA" dir="auto" class="heading" id="Configure_PAM_for_SSH_2FA"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Configure PAM for SSH 2FA</h3><div class="heading-children"><div class="el-ol"><ol>
<li data-line="0" dir="auto">Edit the PAM SSH configuration file :</li>
</ol></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">	<span class="token function">sudo</span> <span class="token function">vim</span> /etc/pam.d/sshd
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-ol"><ol start="2">
<li data-line="0" dir="auto">Add the following line at the beginning :</li>
</ol></div><div class="el-pre"><pre class="language-vim" tabindex="0"><code data-line="0" class="language-vim is-loaded">	auth required pam_google_authenticator<span class="token operator">.</span><span class="token keyword">so</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Configure SSH to Use PAM" dir="auto" class="heading" id="Configure_SSH_to_Use_PAM"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Configure SSH to Use PAM</h3><div class="heading-children"><div class="el-p"><p dir="auto">Edit <code>/etc/ssh/sshd_config</code> to enable PAM, challenge-response authentication and keyboard interactive authentication:</p></div><div class="el-pre"><pre class="language-vim" tabindex="0"><code data-line="0" class="language-vim is-loaded">PasswordAuthentication no
KbdInteractiveAuthentication yes
UsePAM yes
ChallengeResponseAuthentication yes
AuthenticationMethods publickey<span class="token punctuation">,</span>skeyboard<span class="token operator">-</span>interactive
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Comment all the code inside:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> nvim /etc/ssh/sshd_config.d/99-archlinux.conf
<span class="token comment">#comment all the code</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Apply Changes" dir="auto" class="heading" id="Apply_Changes"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Apply Changes</h3><div class="heading-children"><div class="el-p"><p dir="auto">Restart the SSH service to apply all changes :</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> systemctl restart <span class="token function">ssh</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="attention" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Important :</div></div><div class="callout-content">
<p dir="auto">Do not close your current SSH session until youve verified the new configuration works.</p>
</div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Access Control" dir="auto" class="heading" id="Access_Control"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Access Control</h3><div class="heading-children"><div class="el-p"><p dir="auto"><code>LoginGraceTime</code> determines the authentication window for users. </p></div><div class="el-p"><p dir="auto"><code>MaxAuthTries</code> controls how many authentication attempts are permitted before blocking a connection.</p></div><div class="el-p"><p dir="auto"><code>MaxSessions</code> defines how many simultaneous SSH connections a single user can maintain. </p></div><div class="el-p"><p dir="auto">These are the recommended values for these three variables:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">LoginGraceTime <span class="token number">20</span>
MaxAuthTries <span class="token number">3</span>
MaxSessions <span class="token number">5</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">These 3 lines are commented by default, make sure to uncomment them!</div></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Prevent Empty Passwords" dir="auto" class="heading" id="Prevent_Empty_Passwords"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Prevent Empty Passwords</h3><div class="heading-children"><div class="el-p"><p dir="auto">By default, SSH prevents users with empty passwords from accessing the server, but it's always good to double-check.</p></div><div class="el-p"><p dir="auto">Look for the&nbsp;<code>PermitEmptyPasswords</code>&nbsp;variable and make sure it's set to&nbsp;<code>no</code>&nbsp;like this:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token comment">#PermitEmptyPasswords no</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">It's commented out by default. If it's already set to&nbsp;<code>no</code>, you can leave it as is.</p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Idle Timeout Interval" dir="auto" class="heading" id="Idle_Timeout_Interval"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Idle Timeout Interval</h3><div class="heading-children"><div class="el-p"><p dir="auto">Unattended SSH sessions present a significant security vulnerability. When a user maintains an open terminal without activity, this creates an idle connection that could potentially be exploited.</p></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">You can automatically disconnect inactive sessions by configuring two key parameters:</div></div><div class="callout-content">
<p dir="auto"><code>ClientAliveInterval</code> sets how frequently (in seconds) the server sends a verification signal to the client.<br>
<code>ClientAliveCountMax</code> establishes how many consecutive verification attempts can fail before the server terminates the connection. </p>
</div></div></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">ClientAliveInterval <span class="token number">60</span>
ClientAliveCountMax <span class="token number">3</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="X11 Forwarding" dir="auto" class="heading" id="X11_Forwarding"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>X11 Forwarding</h3><div class="heading-children"><div class="el-p"><p dir="auto">By default, SSH can forward X11 sessions, which can be useful for certain graphical applications.</p></div><div class="el-p"><p dir="auto">Unless necessary, disable X11 forwarding in SSH, as the X11 protocol isn't security-oriented.</p></div><div class="el-p"><p dir="auto">Find the&nbsp;&nbsp;<code>X11Forwarding</code>&nbsp;variable and set it to&nbsp;<code>no</code>&nbsp;like this:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">X11Forwarding no
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Disabling non-essential features like X11 forwarding in SSH can greatly strengthen your server's security.</div></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Agent and TCP Forwarding" dir="auto" class="heading" id="Agent_and_TCP_Forwarding"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Agent and TCP Forwarding</h3><div class="heading-children"><div class="el-p"><p dir="auto">SSH agent forwarding lets you use your SSH keys to move from one server to another without keeping keys on the first server.</p></div><div class="el-p"><p dir="auto">SSH TCP forwarding, also known as port forwarding, lets you redirect data between your local and remote machine.</p></div><div class="el-p"><p dir="auto">Disable these two features if you don't need them to minimize the attack surface.</p></div><div class="el-p"><p dir="auto">Find the&nbsp;&nbsp;<code>AllowAgentForwarding</code>&nbsp;and&nbsp;<code>AllowTcpForwarding</code>&nbsp;variables and set them to&nbsp;<code>no</code>&nbsp;like this:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">AllowAgentForwarding no
AllowTcpForwarding no
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Password Authentication" dir="auto" class="heading" id="Password_Authentication"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Password Authentication</h3><div class="heading-children"><div class="el-p"><p dir="auto">Accessing your server usually involves using a password with SSH. But a more secure method is&nbsp;SSH key authentication.</p></div><div class="el-p"><p dir="auto">This uses two keys: a public key on your server and a private key you keep. You get access when the server verifies you have the private key.</p></div><div class="el-p"><p dir="auto">This method is safer than just using a password, as it ensures only someone with the private key can enter the server.</p></div><div class="el-p"><p dir="auto">Find the&nbsp;<code>PasswordAuthentication</code> variable and set its value to&nbsp;<code>no</code>&nbsp;like this:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">PasswordAuthentication no
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">By doing this, you ensure that the server can only be accessed using SSH keys.</div></div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="caution" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Always remember to keep your private key secure.</div></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Reloading SSH" dir="auto" class="heading" id="Reloading_SSH"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Reloading SSH</h3><div class="heading-children"><div class="el-p"><p dir="auto">After you've made your changes, be sure to reload the SSH service to apply them.</p></div><div class="el-p"><p dir="auto">Before that, you should verify the configuration for errors. You can do this using the following command:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> sshd <span class="token parameter variable">-t</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Use this command to restart SSH:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> systemctl restart sshd
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Once the service is reloaded, your changes will be in effect.</p></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">You can also use the&nbsp;<code>sudo sshd -T</code>&nbsp;command to list all variables with their values, allowing you to check whether the changes have taken effect or not.</div></div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="done" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">2FA Configuration Done!</div></div></div></div><div class="el-hr"><hr></div></div></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="Harden network and Kernel with sysctl settings" dir="auto" class="heading" id="Harden_network_and_Kernel_with_sysctl_settings">Harden network and Kernel with sysctl settings</h1><div class="heading-children"><div class="el-p"><p dir="auto">Let me explain the fundamental reasons why we're implementing these security configurations:</p></div><div class="el-h6 heading-wrapper"><h6 data-heading="Network Protection Settings" dir="auto" class="heading" id="Network_Protection_Settings"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Network Protection Settings</h6><div class="heading-children"><div class="el-p"><p dir="auto">Create and edit <code>/etc/sysctl.conf</code> :</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/sysctl.d/90-network-security.conf
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Add the following lines :</p></div><div class="el-pre"><pre class="language-input" tabindex="0"><code data-line="0" class="language-input is-loaded"># Reverse Path Filtering (Prevent Spoofing Attacks)
net.ipv4.conf.all.rp_filter = 1
net.ipv4.conf.default.rp_filter = 1

# Block SYN attacks
net.ipv4.tcp_syncookies = 1
net.ipv4.tcp_max_syn_backlog = 4096
net.ipv4.tcp_synack_retries = 3

# Ignore ICMP redirects
net.ipv4.conf.all.accept_redirects = 0
net.ipv6.conf.all.accept_redirects = 0
net.ipv4.conf.default.accept_redirects = 0
net.ipv6.conf.default.accept_redirects = 0
net.ipv4.conf.all.secure_redirects = 0
net.ipv4.conf.all.send_redirects = 0
net.ipv4.conf.default.send_redirects = 0

# Disable Source Packet Routing
net.ipv4.conf.all.accept_source_route = 0
net.ipv6.conf.all.accept_source_route = 0 
net.ipv4.conf.default.accept_source_route = 0
net.ipv6.conf.default.accept_source_route = 0

# Disable Packet Forwarding (unless server is functioning as router or VPN)
net.ipv4.ip_forward = 0
net.ipv4.conf.all.forwarding = 0
net.ipv6.conf.all.forwarding = 0
net.ipv4.conf.default.forwarding = 0
net.ipv6.conf.default.forwarding = 0

# Protect TCP Connections (TIME-WAIT State)
net.ipv4.tcp_rfc1337 = 1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Why Network Security Hardening (90-network-security.conf)?</div></div><div class="callout-content">
<p dir="auto">Without these protections, your system is vulnerable to:</p>
<ul>
<li data-line="2" dir="auto"><strong>IP Spoofing Attacks</strong>: Attackers can forge the source IP address of packets, making attacks harder to trace and potentially bypassing IP-based access controls.</li>
<li data-line="3" dir="auto"><strong>Denial of Service Attacks</strong>: SYN flood attacks can overwhelm your system by exhausting connection resources with incomplete TCP handshakes.</li>
<li data-line="4" dir="auto"><strong>Man-in-the-Middle Attacks</strong>: ICMP redirect messages can be used to manipulate your routing tables, redirecting your traffic through an attacker's system.</li>
<li data-line="5" dir="auto"><strong>Network Reconnaissance</strong>: Default network behaviors can leak information about your system's network configuration and capabilities.</li>
<li data-line="6" dir="auto"><strong>Traffic Hijacking</strong>: Source routing allows packets to specify their own route through the network, bypassing firewall rules and security controls.</li>
</ul>
</div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="tip" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Security Note :</div></div><div class="callout-content">
<p dir="auto"><strong>Real-world consequence:</strong> Without these protections, an attacker on the same network could redirect your traffic, intercept sensitive data, or use your system as part of a larger attack while hiding their tracks.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Kernel Hardening Settings" dir="auto" class="heading" id="Kernel_Hardening_Settings"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Kernel Hardening Settings</h6><div class="heading-children"><div class="el-p"><p dir="auto">Create and edit <code>/etc/sysctl.d/91-kernel-hardening.conf</code> :</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/sysctl.d/91-kernel-hardening.conf
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Add the following lines:</p></div><div class="el-pre"><pre class="language-input" tabindex="0"><code data-line="0" class="language-input is-loaded"># Harden the BPF JIT Compiler
net.core.bpf_jit_harden = 2
kernel.unprivileged_bpf_disabled = 1 

# Disable Magic Keys
kernel.sysrq = 0

# Restrict Access to Kernel Logs
kernel.dmesg_restrict = 1

# Restrict ptrace Access
kernel.yama.ptrace_scope = 3

# Restrict User Namespaces
kernel.unprivileged_userns_clone = 0

# Address Space Layout Randomization (ASLR)
kernel.randomize_va_space = 2

# Additional kernel hardening 
kernel.kexec_load_disabled = 1
kernel.perf_event_paranoid = 3
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Why Kernel Hardening (91-kernel-hardening.conf)?</div></div><div class="callout-content">
<p dir="auto">Without these restrictions:</p>
<ul>
<li data-line="2" dir="auto"><strong>Privilege Escalation</strong>: Attackers who gain limited access to your system could exploit kernel features to elevate their privileges to root.</li>
<li data-line="3" dir="auto"><strong>Memory Exploits</strong>: Predictable memory layouts make buffer overflow attacks more reliable and easier to execute.</li>
<li data-line="4" dir="auto"><strong>Information Disclosure</strong>: Kernel logs can contain sensitive information like memory addresses that help attackers develop targeted exploits.</li>
<li data-line="5" dir="auto"><strong>Process Hijacking</strong>: Debug facilities like ptrace can be abused to attach to and manipulate running processes, stealing credentials or injecting malicious code.</li>
<li data-line="6" dir="auto"><strong>Kernel Module Exploitation</strong>: Malicious or vulnerable kernel modules can compromise the entire system since they run with kernel privileges.</li>
</ul>
</div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="tip" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Security Note :</div></div><div class="callout-content">
<p dir="auto"><strong>Real-world consequence:</strong> A seemingly minor application vulnerability could be leveraged into full system compromise because the kernel isn't properly hardened against post-exploitation activities.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="File System and Memory Protection" dir="auto" class="heading" id="File_System_and_Memory_Protection"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>File System and Memory Protection</h6><div class="heading-children"><div class="el-p"><p dir="auto">Create and edit <code>/etc/sysctl.d/91-kernel-hardening.conf</code> :</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/sysctl.d/92-fs-memory-protection.conf
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Add the following lines:</p></div><div class="el-pre"><pre class="language-input" tabindex="0"><code data-line="0" class="language-input is-loaded"># Restrict Core Dumps
kernel.core_pattern = |/bin/false
fs.suid_dumpable = 0

# File Creation Restrictions
fs.protected_regular = 2
fs.protected_fifos = 2
fs.protected_hardlinks = 1
fs.protected_symlinks = 1

# Control Swapping
vm.swappiness = 1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Why File System &amp; Memory Protection (92-fs-memory-protection.conf)?</div></div><div class="callout-content">
<p dir="auto">Without these safeguards:</p>
<ul>
<li data-line="2" dir="auto"><strong>Sensitive Data Exposure</strong>: Core dumps can write the complete memory contents of crashed processes to disk, potentially including passwords, encryption keys, and other secrets.</li>
<li data-line="3" dir="auto"><strong>Race Condition Attacks</strong>: Without file protection mechanisms, attackers can exploit the timing between when a file is checked and when it's used (TOCTOU attacks).</li>
<li data-line="4" dir="auto"><strong>Symlink Attacks</strong>: Attackers can create symbolic links to sensitive files in locations where your applications have write access but shouldn't have read access.</li>
<li data-line="5" dir="auto"><strong>Memory Scraping</strong>: More aggressive swapping can write sensitive data from RAM to disk, where it might be recovered even after power loss.</li>
</ul>
</div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="tip" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Security Note :</div></div><div class="callout-content">
<p dir="auto"><strong>Real-world consequence:</strong> A compromised user account could be leveraged to read sensitive system files or extract credentials from memory that would otherwise be inaccessible.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Apply the sittings" dir="auto" class="heading" id="Apply_the_sittings"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Apply the sittings</h6><div class="heading-children"><div class="el-p"><p dir="auto">Reload <code>sysctl</code> :</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> <span class="token function">sysctl</span> <span class="token parameter variable">-p</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="caution" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">In cybersecurity, the goal isn't just to keep attackers out initially, but to make each step of an attack more difficult, more likely to be detected, and less likely to succeed. These sysctl configurations are a key part of that strategy.</div></div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Verifying the Settings" dir="auto" class="heading" id="Verifying_the_Settings"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Verifying the Settings</h6><div class="heading-children"><div class="el-p"><p dir="auto">To verify that all settings have been applied:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Check all configured parameters</span>
<span class="token function">sudo</span> <span class="token function">sysctl</span> <span class="token parameter variable">--system</span>

<span class="token comment"># Or check specific categories</span>
<span class="token function">sysctl</span> <span class="token parameter variable">-a</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"net.ipv4.conf.all.rp_filter"</span>
<span class="token comment">#Should show "net.ipv4.conf.all.rp_filter = 1"</span>
<span class="token function">sysctl</span> <span class="token parameter variable">-a</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"net.ipv4.conf"</span>
<span class="token function">sysctl</span> <span class="token parameter variable">-a</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"kernel"</span>
<span class="token function">sysctl</span> <span class="token parameter variable">-a</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"fs.protected"</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="done" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">Kernel Hardening Done!</div></div></div></div><div class="el-hr"><hr></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Setting Up a Firewall using UFW" dir="auto" class="heading" id="Setting_Up_a_Firewall_using_UFW"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Setting Up a Firewall using UFW</h2><div class="heading-children"><div class="el-p"><p dir="auto">Setting up a firewall is essential for securing your server, and UFW makes this process straightforward and user-friendly.</p></div><div class="el-h6 heading-wrapper"><h6 data-heading="Installing UFW:" dir="auto" class="heading" id="Installing_UFW:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Installing UFW:</h6><div class="heading-children"><div class="el-p"><p dir="auto">On Debian-based distribution, like Ubuntu, UFW often comes pre-packaged, but you can check and install it using theses commands:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># To check if UFW is installed</span>
<span class="token function">sudo</span> ufw status

<span class="token comment"># If it's already installed disable it</span>
<span class="token function">sudo</span> ufw disable
<span class="token function">sudo</span> ufw reset

<span class="token comment"># To install it</span>
<span class="token function">sudo</span> pacman <span class="token parameter variable">-Syu</span> <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> ufw
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre><code data-line="0">--You can re-enable it once you have added all the rules and finished configuring it.
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="UFW's Default Policy" dir="auto" class="heading" id="UFW's_Default_Policy"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>UFW's Default Policy</h6><div class="heading-children"><div class="el-p"><p dir="auto">By default, UFW takes a secure approach by blocking all incoming traffic while allowing outgoing traffic from our server. This means our server can communicate externally, but it remains inaccessible to others.</p></div><div class="el-p"><p dir="auto">Since there is no issue with our server reaching the outside world, there is no need to make any changes to that aspect.</p></div><div class="el-p"><p dir="auto">However, to enable incoming traffic, its essential to selectively open only the required ports and authorize traffic through them.</p></div><div class="el-p"><p dir="auto">You can find the default policy defined in the&nbsp;<code>/etc/default/ufw</code>&nbsp;file:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token assign-left variable">DEFAULT_INPUT_POLICY</span><span class="token operator">=</span><span class="token string">"DROP"</span>
<span class="token assign-left variable">DEFAULT_OUTPUT_POLICY</span><span class="token operator">=</span><span class="token string">"ACCEPT"</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">As you can see, the default policy for incoming traffic is set to&nbsp;<code>DROP</code>, while the default policy for outgoing traffic is set to&nbsp;<code>ACCEPT</code>.</div></div></div></div><div class="el-p"><p dir="auto"><em>If UFW is enabled, you can also review the default policy using the following command:</em></p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw status verbose
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">You can modify this default behavior of UFW either by directly editing the file or by using these two commands:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw default <span class="token operator">&lt;</span>policy<span class="token operator">&gt;</span> incoming
<span class="token function">sudo</span> ufw default <span class="token operator">&lt;</span>policy<span class="token operator">&gt;</span> outgoing
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="caution" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Replace&nbsp;<code>&lt;policy&gt;</code>&nbsp;with either&nbsp;<code>deny</code>,&nbsp;<code>allow</code>&nbsp;or&nbsp;<code>reject</code></div></div><div class="callout-content">
<p dir="auto"><code>deny</code>&nbsp;corresponds to DROP<br>
<code>allow</code>&nbsp;corresponds to ACCEPT<br>
<code>reject</code>&nbsp;corresponds to REJECT.</p>
</div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">What are these options? :</div></div><div class="callout-content">
<p dir="auto">Both DROP and REJECT policies prevent traffic from passing through the firewall, but they differ in their response messages.</p>
<p dir="auto">With DROP, the traffic is silently discarded without any acknowledgment sent to the source. It neither forwards the packet nor responds to it.</p>
<p dir="auto">On the other hand, REJECT sends an error message back to the source, signaling a connection failure.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="UFW's Configuration Files" dir="auto" class="heading" id="UFW's_Configuration_Files"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>UFW's Configuration Files</h6><div class="heading-children"><div class="el-p"><p dir="auto">You can find the UFW configuration file in <code>/etc/default/ufw</code>&nbsp;and examined the default policy of UFW, but there are other settings you might need to know about.</p></div><div class="el-p"><p dir="auto">In this file, you will need to change only one option, the <code>'IPT_SYSCTL file path'</code>:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Since we harder directly the linux kernel, change the IPT_SYSCTL file path</span>
<span class="token assign-left variable">IPT_SYSCTL</span><span class="token operator">=</span>/etc/sysctl.conf
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="tip" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">This is for our configuration only</div></div><div class="callout-content">
<p dir="auto">The only change we make in this file is to the&nbsp;<code>IPT_SYSCTL</code>&nbsp;variable. Theres another file well discuss next, which is&nbsp;<code>/etc/ufw/sysctl.conf</code>.  UFW uses this file to tweak certain kernel parameters.<br>
However, the original file for changing kernel parameters is&nbsp;<code>/etc/sysctl.conf</code>.</p>
</div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Why this option? :</div></div><div class="callout-content">
<p dir="auto">While UFW uses its own version for this purpose, we prefer not to do that. When we&nbsp;harden the <a data-href="#Harden network with sysctl settings" href="#Harden_network_with_sysctl_settings" class="internal-link" target="_self" rel="noopener nofollow">Harden network with sysctl settings</a> we make our changes to kernel parameters directly in the&nbsp;<code>/etc/sysctl.conf</code>&nbsp;file.<br>
That's why we need to change that line, if you did not harder the kernel, do not change it.<br>
This way, I avoid dealing with two files and can maintain a clearer overview of the changes in a single file.</p>
</div></div></div><div class="el-p"><p dir="auto">To incorporate the default changes that UFW makes, you can simply add these to the end of the&nbsp;<code>/etc/sysctl.d/90-network-security.conf</code>&nbsp;file:</p></div><div class="el-pre"><pre><code data-line="0">#In the ICMP redirects section:
net.ipv4.icmp_echo_ignore_broadcasts = 1
net.ipv4.icmp_ignore_bogus_error_responses = 1
net.ipv4.icmp_echo_ignore_all = 0

#Add log_martians section:
net.ipv4.conf.all.log_martians = 0
net.ipv4.conf.default.log_martians = 0
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Now, simply reboot the server for the changes to take effect. Theres no need to enable UFW for the changes to apply, since we are using the original&nbsp;<code>sysctl.conf</code>&nbsp;file.</p></div><div class="el-p"><p dir="auto">The last file we need to review is the&nbsp;<code>/etc/ufw/ufw.conf</code>&nbsp;file, which contains just two variables:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token assign-left variable">ENABLED</span><span class="token operator">=</span>no
<span class="token assign-left variable">LOGLEVEL</span><span class="token operator">=</span>low
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Why this option? :</div></div><div class="callout-content">
<p dir="auto">The first variable controls whether UFW is enabled or disabled. There's no need to change it manually, as enabling or disabling UFW from the command line will automatically update this value.<br>
The second variable controls the log level of UFW. It can be set to&nbsp;<code>off</code>,&nbsp;<code>low</code>,&nbsp;<code>medium</code>,&nbsp;<code>high</code>, or&nbsp;<code>full</code>, depending on how much logging detail you want.</p>
</div></div></div><div class="el-p"><p dir="auto">You can also change the logging level directly from the command line using the following command:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw logging <span class="token operator">&lt;</span>logging_level<span class="token operator">&gt;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre><code data-line="0">-&gt;This will automatically update the value of the&nbsp;`LOGLEVEL`&nbsp;variable.
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="UFW's Rules Files" dir="auto" class="heading" id="UFW's_Rules_Files"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>UFW's Rules Files</h6><div class="heading-children"><div class="el-p"><p dir="auto">In the&nbsp;<code>/etc/ufw/</code>&nbsp;directory, you'll find files with the&nbsp;<code>.rules</code>&nbsp;extension(some example):</p></div><div class="el-pre"><pre class="language-output" tabindex="0"><code data-line="0" class="language-output is-loaded">after6.rules  after.rules  before6.rules  before.rules  user6.rules  user.rules
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">These files control how UFW manages incoming, outgoing, and forwarded traffic. Files with the number&nbsp;<code>6</code>&nbsp;handle IPv6 traffic, while files without it handle IPv4 traffic.</p></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="tip" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Important</div></div><div class="callout-content">
<p dir="auto">It's important to note that you should not modify the&nbsp;<code>user.rules</code>&nbsp;or&nbsp;<code>user6.rules</code>&nbsp;files directly, as any changes could be overwritten by UFW. Rules added by the user from the command line are saved to these files, which is why they are called&nbsp;<code>user.rules</code>&nbsp;files.<br>
You are free to add custom rules only to the&nbsp;<code>before.rules</code>&nbsp;or&nbsp;<code>after.rules</code>&nbsp;files.</p>
</div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="caution" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Important</div></div><div class="callout-content">
<p dir="auto">The order in which UFW processes firewall rules is as follows:&nbsp;<code>before.rules</code>&nbsp;first,&nbsp;<code>user.rules</code>&nbsp;next, and&nbsp;<code>after.rules</code>&nbsp;last.<br>
<em>Understanding the order in which UFW processes these files and their respective roles is essential for effectively managing your firewall.</em></p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Basic User-Defined Rules" dir="auto" class="heading" id="Basic_User-Defined_Rules"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Basic User-Defined Rules</h6><div class="heading-children"><div class="el-p"><p dir="auto">In the following, we'll cover the basic firewall rules that can be added from the command line.</p></div><div class="el-p"><p dir="auto">UFW offers a set of commands for managing firewall rules directly, allowing you to quickly specify which services or ports are allowed or denied.</p></div><div class="el-p"><p dir="auto">While these rules are designed for basic network access control and aren't intended for advanced use cases, they are perfect for setting up a firewall swiftly and efficiently.</p></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="tip" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">  To review the rules you've added when the firewall is disabled, use the command&nbsp;<code>sudo ufw show added</code>, as&nbsp;<code>sudo ufw status</code>&nbsp;wont display the rules in that case.</p>
</div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="caution" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Remember</div></div><div class="callout-content">
<p dir="auto">Every rule you add from the command line is saved to the&nbsp;<code>user.rules</code>&nbsp;file, so feel free to check it as you add rules to understand how UFW translates the commands into the file.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Allowing and Denying Traffic" dir="auto" class="heading" id="Allowing_and_Denying_Traffic"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Allowing and Denying Traffic</h6><div class="heading-children"><div class="el-p"><p dir="auto">The core functionality of UFW is to allow or deny network traffic.</p></div><div class="el-p"><p dir="auto">To allow or deny traffic for specific ports, you use the&nbsp;<code>allow</code>&nbsp;or&nbsp;<code>deny</code>&nbsp;rules, respectively.</p></div><div class="el-p"><p dir="auto">To allow incoming traffic on port 22 (SSH):</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw allow <span class="token number">22</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">You can also specify a protocol (TCP or UDP):</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw allow <span class="token number">22</span>/tcp
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">To deny traffic on port 80(HTPP):</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw deny <span class="token number">80</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">If a range of ports is required, such as 5000-6000, use the following:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw allow <span class="token number">5000</span>:6000/tcp
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Similarly, to deny traffic for the same range:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw deny <span class="token number">5000</span>:6000/tcp
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">You can also allow or deny traffic based on a service's name instead of specifying a port number. For example, to allow SSH traffic by using the service name, you can use:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw allow <span class="token function">ssh</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">UFW will then automatically determine the correct port (port 22 for SSH) and the associated protocol (TCP) to apply the rule. This approach simplifies rule management, especially when dealing with well-known services.</p></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="caution" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Caution</div></div><div class="callout-content">
<p dir="auto">In our case, we have changed the port of our ssh, so this command do not work.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Application Profiles" dir="auto" class="heading" id="Application_Profiles"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Application Profiles</h6><div class="heading-children"><div class="el-p"><p dir="auto">Applications (software or services installed) can register their profiles with UFW upon installation, enabling UFW to manage them by name.</p></div><div class="el-p"><p dir="auto">To view the available profiles, you can use the following command:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw app list
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">For instance, to allow traffic on port 443 (HTTPS), you can use the following commands:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw allow <span class="token string">"NGINX HTTPS"</span>
<span class="token function">sudo</span> ufw allow <span class="token string">"Apache Secure"</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="tip" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">If youre curious about the origins of these profiles, check the&nbsp;<code>/etc/ufw/applications.d/</code>&nbsp;directory.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="The `Limit` Rule" dir="auto" class="heading" id="The_`Limit`_Rule"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>The <code>Limit</code> Rule</h6><div class="heading-children"><div class="el-p"><p dir="auto">The&nbsp;<code>limit</code>&nbsp;rule&nbsp;in UFW helps protect against brute-force attacks by restricting the number of connection attempts an IP can make in a short time.</p></div><div class="el-p"><p dir="auto">For example, when securing SSH, this rule lets legitimate users connect but temporarily blocks any IP that makes too many failed attempts.</p></div><div class="el-p"><p dir="auto">By default, the rule allows only&nbsp;6 connections&nbsp;from the same IP within&nbsp;30 seconds. If the limit is exceeded, the IP is blocked temporarily, which reduces the risk of brute-force attacks.</p></div><div class="el-p"><p dir="auto">To apply this rule for SSH traffic:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw limit <span class="token number">22</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre><code data-line="0">-&gt;This command enables SSH access while protecting the server from excessive connection attempts.
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Access Control by IP or Subnet" dir="auto" class="heading" id="Access_Control_by_IP_or_Subnet"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Access Control by IP or Subnet</h6><div class="heading-children"><div class="el-p"><p dir="auto">UFW lets you control access based on IP addresses or subnets, which is useful for limiting access to specific clients or denying access from specific sources.</p></div><div class="el-p"><p dir="auto">To allow all traffic from a specific IP to any port:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw allow from <span class="token number">192.168</span>.1.100
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">To allow SSH traffic only from a specific IP:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw allow from <span class="token number">192.168</span>.1.100 to any port <span class="token number">22</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">To allow traffic from a subnet:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw allow from <span class="token number">192.168</span>.1.0/24
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">To deny traffic from a specific IP address:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw deny from <span class="token number">203.0</span>.113.50
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">In some cases, you might want to specify not just the IP or subnet but also the protocol (TCP or UDP).</p></div><div class="el-p"><p dir="auto">For example, to allow only TCP traffic from an IP address to port 80, you can specify the protocol as follows:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw allow from <span class="token number">192.168</span>.1.100 to any port <span class="token number">80</span> proto tcp
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">By specifying protocols in your access control rules, you gain more control over the traffic flow, ensuring that only the desired traffic (TCP or UDP) is allowed from specific sources or networks.</p></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Enabling and Checking Status" dir="auto" class="heading" id="Enabling_and_Checking_Status"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Enabling and Checking Status</h6><div class="heading-children"><div class="el-p"><p dir="auto">Before activating our firewall, its crucial to review the rules weve added so far to prevent any unexpected behavior.</p></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="tip" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">As I mentioned earlier, if the firewall is disabled, we can't use the&nbsp;<code>sudo ufw status</code>&nbsp;command to view our rules.<br>
Instead, we use the&nbsp;<code>sudo ufw show added</code>&nbsp;command. This command will list all the rules we have added.<br>
<em>Always add the rules, review them, and then proceed to enable the firewall.</em></p>
</div></div></div><div class="el-p"><p dir="auto">To enable UFW and apply the rules youve configured, use the following command:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw <span class="token builtin class-name">enable</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Now, you can check the status of UFW and your current ruleset using the&nbsp;<code>sudo ufw status</code>&nbsp;command.</p></div><div class="el-p"><p dir="auto">For a more detailed view:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw status verbose
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="tip" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">If you experience any issues, disable UFW using&nbsp;<code>sudo ufw disable</code>&nbsp;and review your rules again.<br>
If you need to reset UFW to its default state (removing all rules), you can use the&nbsp;<code>sudo ufw reset</code>&nbsp;command.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Deleting Rules" dir="auto" class="heading" id="Deleting_Rules"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Deleting Rules</h6><div class="heading-children"><div class="el-p"><p dir="auto">If, for some reason, you want to delete a rule you have added, you can use the&nbsp;<code>sudo ufw delete</code>command followed by the rule itself like this:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw delete deny from <span class="token number">111.111</span>.111.111 to any port <span class="token number">80</span> proto tcp
<span class="token function">sudo</span> ufw delete allow <span class="token number">80</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">There is another easier way to delete rules, but it requires the firewall to be enabled. This method involves using the rule number.</p></div><div class="el-p"><p dir="auto">Once the firewall is enabled, you can use the&nbsp;<code>sudo ufw status numbered</code>&nbsp;command to obtain a list of your rules and their corresponding numbers, like this:</p></div><div class="el-pre"><pre class="language-output" tabindex="0"><code data-line="0" class="language-output is-loaded">To                         Action      From
--                         ------      ----
[ 1] 22/tcp                ALLOW IN    Anywhere                  
[ 2] 22/tcp (v6)           ALLOW IN    Anywhere (v6)  
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Now, to delete a rule, you can simply use the rule number:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw delete <span class="token number">1</span> 
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre><code data-line="0">-&gt;This is a much simpler method.
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Best Practices" dir="auto" class="heading" id="Best_Practices"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Best Practices</h6><div class="heading-children"><div class="el-p"><p dir="auto">The first step before enabling a firewall is to allow SSH traffic to ensure access to the server. If you enable the firewall before adding this rule, you risk losing access to your server.</p></div><div class="el-p"><p dir="auto">We showed you how to use the&nbsp;<code>allow</code>&nbsp;or&nbsp;<code>limit</code>&nbsp;rules. Using these rules will permit any IP address to access port 22, which means our SSH port is open to everyone. This is something we avoid on a production server.</p></div><div class="el-p"><p dir="auto">If we have a static IP from which we can access the server, we restrict the SSH port to that IP. This provides an extra layer of security and reduces the risk of unauthorized access.</p></div><div class="el-p"><p dir="auto">Even if youve generated an SSH key pair, implemented key authentication, and created a non-root user, hackers could still attempt to breach your server.</p></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="tip" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Tips</div></div><div class="callout-content">
<p dir="auto">Only restrict the SSH port to your IP if its static  such as when using a VPN service or if your ISP has assigned you a static IP.</p>
</div></div></div><div class="el-p"><p dir="auto">If you have a static IP, use the following command:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw allow from <span class="token operator">&lt;</span>YOUR_IP<span class="token operator">&gt;</span> proto tcp to any port <span class="token number">22</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Now, the IP specified in the command is the only one that can access the server.</p></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="caution" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Caution</div></div><div class="callout-content">
<p dir="auto">When you restrict SSH access to a single IP,&nbsp;Fail2Ban&nbsp;becomes irrelevant since there are no IPs to block. However, I still recommend keeping Fail2ban installed and enabled.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Advanced Firewall Rules" dir="auto" class="heading" id="Advanced_Firewall_Rules"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Advanced Firewall Rules</h6><div class="heading-children"><div class="el-p"><p dir="auto">Up until now, weve focused on basic user-defined rules that you can easily manage from the command line.</p></div><div class="el-p"><p dir="auto">Now, well introduce the idea of advanced rules, which allow you to control traffic at a deeper level by configuring UFW's&nbsp;<code>/etc/ufw/before.rules</code>&nbsp;files.</p></div><div class="el-p"><p dir="auto">These advanced rules let you filter traffic&nbsp;before it reaches your servers services&nbsp;and&nbsp;before the firewall applies its standard rules.</p></div><div class="el-p"><p dir="auto">Advanced rules are incredibly powerful and can be tailored to specific use cases, offering finer control over your network's security and performance.</p></div><div class="el-p"><p dir="auto">And as we mentioned earlier, all of UFW's rule files primarily use the iptables syntax.</p></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Structure of `before.rules` Files" dir="auto" class="heading" id="Structure_of_`before.rules`_Files"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Structure of <code>before.rules</code> Files</h6><div class="heading-children"><div class="el-p"><p dir="auto">The&nbsp;<code>before.rules</code>&nbsp;file begins with a declaration of the&nbsp;<code>*filter</code>&nbsp;table and defines several custom chains:</p></div><div class="el-pre"><pre class="language-output" tabindex="0"><code data-line="0" class="language-output is-loaded">*filter
:ufw-before-input - [0:0]
:ufw-before-output - [0:0]
:ufw-before-forward - [0:0]
:ufw-not-local - [0:0]
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Why theses option? :</div></div><div class="callout-content">
<ul>
<li data-line="1" dir="auto"><code>:ufw-before-input</code>: Processes incoming packets.</li>
<li data-line="2" dir="auto"><code>:ufw-before-forward</code>: Handles packets forwarded through the server.</li>
<li data-line="3" dir="auto"><code>:ufw-not-local</code>: Deals with packets that are not addressed to or from the local system.</li>
</ul>
</div></div></div><div class="el-p"><p dir="auto">It includes several default rules to handle fundamental network operations and improve security. These rules cover a variety of scenarios, such as allowing all traffic on loopback interfaces or dropping invalid packets. <strong>They are applied by default once you enable the firewall</strong>.<br>
The file ends with the&nbsp;<code>COMMIT</code>&nbsp;line, signaling the completion of the rules.</p></div><div class="el-p"><p dir="auto">The structure in&nbsp;<code>before6.rules</code>&nbsp;for IPv6 is nearly identical to that of&nbsp;<code>before.rules</code>&nbsp;for IPv4.</p></div><div class="el-p"><p dir="auto">The main difference is that the chains in&nbsp;<code>before6.rules</code>&nbsp;all have the number&nbsp;<code>6</code>&nbsp;added to their names, like this:</p></div><div class="el-pre"><pre class="language-output" tabindex="0"><code data-line="0" class="language-output is-loaded">*filter
:ufw6-before-input - [0:0]
:ufw6-before-output - [0:0]
:ufw6-before-forward - [0:0]
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">However, unlike&nbsp;<code>before.rules</code>,&nbsp;<code>before6.rules</code>&nbsp;does not include a&nbsp;<code>ufw6-not-local</code>&nbsp;chain.</p></div><div class="el-p"><p dir="auto">It includes some of the default rules that&nbsp;<code>before.rules</code>&nbsp;has, but it also contains additional rules that are applied specifically to IPv6 traffic.</p></div><div class="el-p"><p dir="auto">The file also ends with the&nbsp;<code>COMMIT</code>&nbsp;line, signaling the completion of the rules.</p></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Use Case" dir="auto" class="heading" id="Use_Case"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Use Case</h6><div class="heading-children"><div class="el-p"><p dir="auto">As we mentioned earlier, these files take priority, meaning they are executed first.</p></div><div class="el-p"><p dir="auto">This allows us to define rules that will take effect before traffic reaches anything running on the server and before it travels further through the firewall.</p></div><div class="el-p"><p dir="auto">You can, for example, implement a solution to block SYN flood attacks&nbsp;by rate-limiting the number of SYN packets allowed through ports 80 and 443, and block IPs exceeding these limits. This is something that cannot be done using basic user-defined rules from the command line.</p></div><div class="el-p"><p dir="auto">While you can use the&nbsp;<code>limit</code>&nbsp;rule for ports 80 and 443, its not ideal for a web server since the limits may not be well-suited to handle the typical traffic patterns of a web server.</p></div><div class="el-p"><p dir="auto">Using more advanced rules in&nbsp;<code>before.rules</code>&nbsp;allows you to fine-tune the firewall for specific use cases like this.</p></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">What's SYN flood attacks?:</div></div><div class="callout-content">
<p dir="auto">SYN flood attacks&nbsp;are a common and dangerous type of attack that can overwhelm a server by sending an excessive number of connection requests, ultimately disrupting legitimate traffic and potentially causing the server to go down.</p>
</div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Example of Advanced Rules" dir="auto" class="heading" id="Example_of_Advanced_Rules"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Example of Advanced Rules</h6><div class="heading-children"><div class="el-p"><p dir="auto">If you examine the contents of the&nbsp;<code>before.rules</code>&nbsp;file, you will notice these two rules:</p></div><div class="el-pre"><pre class="language-output" tabindex="0"><code data-line="0" class="language-output is-loaded">-A ufw-before-input -m conntrack --ctstate INVALID -j ufw-logging-deny
-A ufw-before-input -m conntrack --ctstate INVALID -j DROP
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Why this option? :</div></div><div class="callout-content">
<p dir="auto">These two rules are designed to log and block any invalid packets, and they are added by default by UFW to the&nbsp;<code>ufw-before-input</code>&nbsp;chain, which filters incoming traffic before it reaches the server, ensuring that only legitimate connections are allowed.</p>
</div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">What is Invalid Packet?:</div></div><div class="callout-content">
<p dir="auto">Hackers use tools to create TCP packets with unusual, weird flag combinations, known as&nbsp;<strong>Invalid&nbsp;Packets</strong>, capable of causing significant harm.<br>
UFW&nbsp;blocks these invalid packets by default, but there are still instances where it may overlook and fail to block.</p>
</div></div></div><div class="el-p"><p dir="auto">UFW uses the&nbsp;<code>conntrack</code>&nbsp;module (short for connection tracking) to monitor connections and identify those with&nbsp;<code>INVALID</code>&nbsp;connection states. While these rules are effective, we can make them even better.</p></div><div class="el-p"><p dir="auto">To further enhance the security of our server, we could add two additional rules to log and block any new connections that dont have only the SYN flag set.</p></div><div class="el-p"><p dir="auto">Add the following two rules below the ones added by default by UFW:</p></div><div class="el-pre"><pre class="language-input" tabindex="0"><code data-line="0" class="language-input is-loaded">-A ufw-before-input -p tcp -m tcp ! --tcp-flags FIN,SYN,RST,ACK SYN -m conntrack --ctstate NEW -j ufw-logging-deny
-A ufw-before-input -p tcp -m tcp ! --tcp-flags FIN,SYN,RST,ACK SYN -m conntrack --ctstate NEW -j DROP
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Don't forget to add them to the&nbsp;<code>before6.rules</code>&nbsp;file as well:</p></div><div class="el-pre"><pre class="language-input" tabindex="0"><code data-line="0" class="language-input is-loaded">-A ufw6-before-input -p tcp -m tcp ! --tcp-flags FIN,SYN,RST,ACK SYN -m conntrack --ctstate NEW -j ufw6-logging-deny
-A ufw6-before-input -p tcp -m tcp ! --tcp-flags FIN,SYN,RST,ACK SYN -m conntrack --ctstate NEW -j DROP
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">Why this option? :</div></div><div class="callout-content">
<p dir="auto">-The first rule drops any packet thats considered&nbsp;<code>INVALID</code>&nbsp;by the&nbsp;<code>conntrack</code>&nbsp;module.<br>
-The second rule blocks TCP packets that are flagged as&nbsp;<code>NEW</code>&nbsp;(indicating new connection attempts) but dont have the SYN flag set&nbsp;alone.</p>
</div></div></div><div class="el-p"><p dir="auto">Now, reload UFW if it is already enabled:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> ufw reload
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">These additional rules further enhance the firewalls ability to filter out potentially malicious packets and protect your server from unwanted connection attempts.</p></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="done" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">Firewall Using UFW Done!</div></div></div></div><div class="el-hr"><hr></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="warning" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Warning</div></div><div class="callout-content heading-wrapper">
<h4 data-heading="IF YOU ARE MAKING THE REVERSE PROXY YOU NEED TO DO THESES STEP BELLOW." dir="auto" class="heading" id="IF_YOU_ARE_MAKING_THE_REVERSE_PROXY_YOU_NEED_TO_DO_THESES_STEP_BELLOW."><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>IF YOU ARE MAKING THE REVERSE PROXY YOU NEED TO DO THESES STEP BELLOW.</h4>
<p dir="auto">But you can do it to the web server too to enhance the security.</p>
<div class="heading-children"></div></div></div></div></div></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="Installing and configuring Fail2Ban" dir="auto" class="heading" id="Installing_and_configuring_Fail2Ban">Installing and configuring Fail2Ban</h1><div class="heading-children"><div class="el-p"><p dir="auto">Fail2ban is available in Arch-Linux repositories.</p></div><div class="el-p"><p dir="auto">To install it, use this command:</p></div><div class="el-pre"><pre><code data-line="0">sudo pacman -S fail2ban
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h6 heading-wrapper"><h6 data-heading="Pre-Configuration" dir="auto" class="heading" id="Pre-Configuration"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Pre-Configuration</h6><div class="heading-children"><div class="el-p"><p dir="auto">Fail2ban's configuration files are located in the&nbsp;<code>/etc/fail2ban/</code>&nbsp;directory.</p></div><div class="el-p"><p dir="auto">If you list the contents of this directory, you will find two important configuration files:&nbsp;</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">The&nbsp;<code>fail2ban.conf</code>&nbsp;file contains Fail2Ban's global settings, which I don't recommend modifying.</li>
<li data-line="1" dir="auto">The&nbsp;<code>jail.conf</code>&nbsp;file contains jails, filters with actions.</li>
</ul></div><div class="el-p"><p dir="auto">Fail2Ban recommends creating two local copies of these configuration files for us to modify.</p></div><div class="el-p"><p dir="auto">Use the following commands to create a local copy of these two files:</p></div><div class="el-pre"><pre><code data-line="0">sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local
sudo cp /etc/fail2ban/fail2ban.conf /etc/fail2ban/fail2ban.local
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="done" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">Now you can safely modify Fail2Ban's configuration.</div></div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Configuration" dir="auto" class="heading" id="Configuration"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Configuration</h6><div class="heading-children"><div class="el-p"><p dir="auto">Open the&nbsp;<code>jail.local</code>&nbsp;file with your preferred editor and examine its settings.</p></div><div class="el-p"><p dir="auto">Under the&nbsp;<code>[DEFAULT]</code>&nbsp;section, there are some variables that you may want to modify.</p></div><div class="el-pre"><pre><code data-line="0">bantime
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The&nbsp;<code>bantime</code>&nbsp;variable sets the duration for which an IP will be blocked from accessing the server after failing to authenticate correctly.</p></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">By default, this is set to 10 minutes.</div></div></div></div><div class="el-pre"><pre><code data-line="0">findtime
maxretry
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The&nbsp;<code>maxretry</code>&nbsp;variable defines the number of authentication attempts an IP is allowed to make within a time period defined by&nbsp;<code>findtime</code>&nbsp;before being blocked.</p></div><div class="el-p"><p dir="auto">With the default settings, Fail2Ban will block an IP that unsuccessfully attempts to access the server more than 5 times within a 10-minute interval.</p></div><div class="el-pre"><pre><code data-line="0">#ignoreip = 127.0.0.1/8 ::1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The&nbsp;<code>ignoreip</code>&nbsp;variable contains a list of IP addresses, CIDR masks, or DNS hosts that Fail2ban won't block.</p></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">By default, this variable is commented out.</div></div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Email Alerts" dir="auto" class="heading" id="Email_Alerts"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Email Alerts</h6><div class="heading-children"><div class="el-p"><p dir="auto">If you want to receive email alerts whenever Fail2ban blocks an IP, you should adjust these two variables inside the&nbsp;<code>jail.local</code>&nbsp;file:</p></div><div class="el-pre"><pre><code data-line="0">destemail
sender
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The&nbsp;<code>destemail</code>&nbsp;variable defines the email address to which the alerts should be sent.</p></div><div class="el-p"><p dir="auto">The&nbsp;<code>sender</code>&nbsp;variable defines the email address from which the alerts will be sent.</p></div><div class="el-p"><p dir="auto">The sender variable should look like this:</p></div><div class="el-pre"><pre><code data-line="0">sender = root@example.com
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Lastly, there is the&nbsp;<code>mta</code>&nbsp;variable, which specifies the mail agent that will be used to send the emails.</p></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner">By default, Fail2ban uses Sendmail as its mail agent. You can change this with the <code>mta</code> variable.</div></div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Default Action" dir="auto" class="heading" id="Default_Action"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Default Action</h6><div class="heading-children"><div class="el-p"><p dir="auto">If you scroll down a bit inside the&nbsp;<code>jail.local</code>&nbsp;file, you'll see the&nbsp;<code>action</code>&nbsp;variable:</p></div><div class="el-pre"><pre><code data-line="0">action = %(action_)s
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">This variable dictates the action Fail2ban should take when blocking an IP address.</p></div><div class="el-p"><p dir="auto">The default action is to add a firewall rule that rejects traffic from the IP address, removing it after the specified&nbsp;<code>bantime</code> elapses.</p></div><div class="el-p"><p dir="auto">Above the action variable, you'll find various actions you can switch between :</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><code>action_mw</code>&nbsp;sends an email when taking action</li>
<li data-line="1" dir="auto"><code>action_mwl</code>&nbsp;sends an email and includes logging</li>
<li data-line="2" dir="auto"><code>action_cf_mwl</code>&nbsp;does all of the above, plus sends an update to the Cloudflare API associated with your account to ban the attacker there as well</li>
</ul></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="tip" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg></div><div class="callout-title-inner">Pick the one that suits you the most.</div></div></div></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Individual Jails" dir="auto" class="heading" id="Individual_Jails"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Individual Jails</h6><div class="heading-children"><div class="el-p"><p dir="auto">Now, it is time to examine the service-specific sections, also known as individual jails, such as the&nbsp;<code>[sshd]</code>&nbsp;jail, which protects our server from unauthorized access attempts.</p></div><div class="el-p"><p dir="auto">Each of these jails needs to be individually enabled by adding an&nbsp;<code>enabled = true</code>&nbsp;line under the header, along with their other settings.</p></div><div class="el-p"><p dir="auto">By default, only the&nbsp;<code>[sshd]</code>&nbsp;jail is enabled, and all others are disabled.</p></div><div class="el-p"><p dir="auto">Scroll down the&nbsp;<code>jail.conf</code>&nbsp;file until you find the&nbsp;<code>[sshd]</code>&nbsp;jail, which should look similar to this:</p></div><div class="el-pre"><pre><code data-line="0">enabled = true
port    = ssh
logpath = %(sshd_log)s
backend = %(sshd_backend)s
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">If you've changed the SSH port, ensure to update the value of the&nbsp;<code>port</code>&nbsp;variable accordingly.</p></div><div class="el-p"><p dir="auto">You can include variables defined in the&nbsp;<code>[DEFAULT]</code>&nbsp;section, such as the&nbsp;<code>bantime</code>,&nbsp;<code>maxretry</code>, and&nbsp;<code>findtime</code>&nbsp;variables, which will only apply to this jail.</p></div><div class="el-p"><p dir="auto">If you scroll down further, you'll find other jails that are disabled, such as the&nbsp;<code>[nginx-http-auth]</code>&nbsp;or&nbsp;<code>[apache-auth]</code> jails.</p></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Starting Fail2ban" dir="auto" class="heading" id="Starting_Fail2ban"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Starting Fail2ban</h6><div class="heading-children"><div class="el-p"><p dir="auto">Since the&nbsp;<code>[sshd]</code>&nbsp;jail, which protects SSH, is enabled, we can proceed to start and enable the <code>fail2ban</code>&nbsp;service if it is disabled, depending on the version of Ubuntu you are using.</p></div><div class="el-p"><p dir="auto">Use the following commands to start and enable Fail2ban:</p></div><div class="el-pre"><pre><code data-line="0">sudo systemctl start fail2ban
sudo systemctl enable fail2ban
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">You can use the&nbsp;<code>fail2ban-client</code>&nbsp;command to check the active jails:</p></div><div class="el-pre"><pre><code data-line="0">sudo fail2ban-client status
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Output:</p></div><div class="el-pre"><pre><code data-line="0">Status
|- Number of jail:	1
`- Jail list:	sshd
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">To view the status and information regarding a specific jail like the&nbsp;<code>sshd</code>&nbsp;jail, you can use the following command:</p></div><div class="el-pre"><pre><code data-line="0">sudo fail2ban-client status sshd
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Output:</p></div><div class="el-pre"><pre><code data-line="0">Status for the jail: sshd
|- Filter
|  |- Currently failed:	5
|  |- Total failed:	21
|  `- File list:	/var/log/auth.log
`- Actions
   |- Currently banned:	1
   |- Total banned:	2
   `- Banned IP list:	218.92.0.29
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="caution" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">If you have disabled password authentication for SSH, you may notice zero failed attempts.</div></div></div></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="done" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">Fail2Ban Configuration Done!</div></div></div></div><div class="el-hr"><hr></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="warning" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Warning</div></div><div class="callout-content heading-wrapper">
<h4 data-heading="IF YOU ARE MAKING THE WEB SERVER AND NOT THE REVERSE PROXY YOU NEED TO DO THESES STEP BELLOW during the base install of your arch-linux" dir="auto" class="heading" id="IF_YOU_ARE_MAKING_THE_WEB_SERVER_AND_NOT_THE_REVERSE_PROXY_YOU_NEED_TO_DO_THESES_STEP_BELLOW_during_the_base_install_of_your_arch-linux"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>IF YOU ARE MAKING THE WEB SERVER AND NOT THE REVERSE PROXY YOU NEED TO DO THESES STEP BELLOW during the base install of your arch-linux</h4>
<div class="heading-children"></div></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Now we will crypt the http partition onto the /data for the web-server" dir="auto" class="heading" id="Now_we_will_crypt_the_http_partition_onto_the_/data_for_the_web-server"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Now we will crypt the http partition onto the /data for the web-server</h2><div class="heading-children"><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="warning" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg></div><div class="callout-title-inner">Warning</div></div><div class="callout-content">
<p dir="auto">You need to be onto the archlinux iso to do it, not on your arch-chroot</p>
</div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Create a new logical volume" dir="auto" class="heading" id="Create_a_new_logical_volume"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Create a new logical volume</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">lvcreate <span class="token parameter variable">-L</span> 5G vg0 <span class="token parameter variable">-n</span> httpdata  <span class="token comment"># Create a new logical volume</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Encrypt it separately" dir="auto" class="heading" id="Encrypt_it_separately"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Encrypt it separately</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">cryptsetup luksFormat /dev/vg0/httpdata  <span class="token comment"># Encrypt it separately</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Open the volume" dir="auto" class="heading" id="Open_the_volume"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Open the volume</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">cryptsetup <span class="token function">open</span> /dev/vg2/httpdata crypthttp
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Format the partition" dir="auto" class="heading" id="Format_the_partition"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Format the partition</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">mkfs.ext4 /dev/mapper/crypthttp
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /mnt/data/http
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Mount the partition" dir="auto" class="heading" id="Mount_the_partition"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Mount the partition</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">mount</span> /dev/mapper/crypthttp /mnt/data/http
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Then you can umount and reboot" dir="auto" class="heading" id="Then_you_can_umount_and_reboot"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Then you can umount and reboot</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">umount</span> <span class="token parameter variable">-a</span>
<span class="token function">reboot</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="IN YOUR RUNNIG ARCH LINUX MACHINE AFTER REBOOTING" dir="auto" class="heading" id="IN_YOUR_RUNNIG_ARCH_LINUX_MACHINE_AFTER_REBOOTING"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>IN YOUR RUNNIG ARCH LINUX MACHINE AFTER REBOOTING</h3><div class="heading-children"><div class="el-p"><p dir="auto">Then we need to do a script to decrypt the http partition, and a script to lunch the decrypt partition when the user localadm login.</p></div><div class="el-h4 heading-wrapper"><h4 data-heading="Create the script that mount the encrypted http partition" dir="auto" class="heading" id="Create_the_script_that_mount_the_encrypted_http_partition"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Create the script that mount the encrypted http partition</h4><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">nvim /usr/local/bin/mount-httpdata.sh
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">ADD THIS CONTENT:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token shebang important">#!/bin/bash</span>

<span class="token comment"># Check if already mounted</span>
<span class="token keyword">if</span> mountpoint <span class="token parameter variable">-q</span> /data/http<span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"HTTP data partition is already mounted."</span>
    <span class="token builtin class-name">exit</span> <span class="token number">0</span>
<span class="token keyword">fi</span>

<span class="token comment"># Try to unlock and mount</span>
<span class="token builtin class-name">echo</span> <span class="token string">"Unlocking HTTP data partition..."</span>
<span class="token keyword">if</span> cryptsetup <span class="token function">open</span> /dev/vg0/httpdata crypthttp<span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"Mounting HTTP data partition..."</span>
    <span class="token function">mount</span> /dev/mapper/crypthttp /data/http
    <span class="token builtin class-name">echo</span> <span class="token string">"HTTP data partition mounted successfully."</span>
    
    <span class="token comment"># Set proper ownership and permissions</span>
    <span class="token function">chown</span> localadm:http /data/http <span class="token comment">#Here we use http groupe for nginx on arch linux</span>
    <span class="token function">chmod</span> <span class="token number">750</span> /data/http
    
    <span class="token comment"># Restart web server if needed</span>
    systemctl restart nginx
<span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"Failed to unlock HTTP data partition."</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h6 heading-wrapper"><h6 data-heading="Then we need to make this script executable:" dir="auto" class="heading" id="Then_we_need_to_make_this_script_executable:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Then we need to make this script executable:</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">chmod</span> +x /usr/local/bin/mount-httpdata.sh
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Now that the script to decrypt and mount the http partition is done, we need to make a script to exec it on localadm login.</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">nvim /home/localadm/.bash_profile
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">ADD THIS CONTENT TO THE END OF THE FILE:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token comment"># Check if HTTP partition is mounted</span>
<span class="token keyword">if</span> <span class="token operator">!</span> mountpoint <span class="token parameter variable">-q</span> /data/http<span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"HTTP data partition is not mounted."</span>
    <span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">"Would you like to mount it now? (y/n): "</span> response
    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$response</span>"</span> <span class="token operator">=~</span> ^<span class="token punctuation">[</span>Yy<span class="token punctuation">]</span>$ <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token function">sudo</span> /usr/local/bin/mount-httpdata.sh
    <span class="token keyword">fi</span>
<span class="token keyword">fi</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Install and configure Nginx" dir="auto" class="heading" id="Install_and_configure_Nginx"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Install and configure Nginx</h4><div class="heading-children"><div class="el-h6 heading-wrapper"><h6 data-heading="Install nginx" dir="auto" class="heading" id="Install_nginx"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Install nginx</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> pacman <span class="token parameter variable">-Syu</span> <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> nginx
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Create a maintenance page" dir="auto" class="heading" id="Create_a_maintenance_page"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Create a maintenance page</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/usr/share/nginx/html/maintenance.html
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Add a simple maintenance page:</p></div><div class="el-pre"><pre class="language-html" tabindex="0"><code data-line="0" class="language-html is-loaded"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Maintenance<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">body</span> <span class="token punctuation">{</span> <span class="token property">font-family</span><span class="token punctuation">:</span> Arial<span class="token punctuation">,</span> sans-serif<span class="token punctuation">;</span> <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">40</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode color">#585a59</span><span class="token punctuation">;</span> <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#FFF</span> <span class="token punctuation">}</span>
        <span class="token selector">h1</span> <span class="token punctuation">{</span> <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#FFF</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token selector"><span class="token class">.container</span></span> <span class="token punctuation">{</span> <span class="token property">max-width</span><span class="token punctuation">:</span> <span class="token number">600</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span> auto<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Site Under Maintenance<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>The website is currently undergoing maintenance. Please check back later.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Configure Nginx" dir="auto" class="heading" id="Configure_Nginx"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Configure Nginx</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/nginx/nginx.conf  <span class="token comment"># or the appropriate site configuration</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Add this logic to your server block:</p></div><div class="el-pre"><pre class="language-nginx" tabindex="0"><code data-line="0" class="language-nginx is-loaded"><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span> www.manual-arch-install.local</span><span class="token punctuation">;</span>
    
    <span class="token directive"><span class="token keyword">root</span> /data/http/encrypted-arch-linux</span><span class="token punctuation">;</span>
	<span class="token directive"><span class="token keyword">index</span> encrypted-arch-linux.html</span><span class="token punctuation">;</span>
	
    <span class="token comment">#Maintenance page logic</span>
    <span class="token directive"><span class="token keyword">error_page</span> <span class="token number">403</span> <span class="token number">404</span> /maintenance.html</span><span class="token punctuation">;</span>
	<span class="token directive"><span class="token keyword">location</span> = /maintenance.html</span> <span class="token punctuation">{</span>
		<span class="token directive"><span class="token keyword">root</span> /usr/share/nginx/html</span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">internal</span></span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
    
    <span class="token directive"><span class="token keyword">access_log</span>  /var/log/nginx/access.log</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">error_log</span>   /var/log/nginx/error.log warn</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Then create an index.html file for your main website" dir="auto" class="heading" id="Then_create_an_index.html_file_for_your_main_website"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Then create an index.html file for your main website</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> pacman <span class="token parameter variable">-Syu</span> <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> pacman <span class="token parameter variable">-S</span> <span class="token function">git</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Then we will download our main website file on git:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">git</span> clone https://github.com/Asashi-Git/encrypted-arch-linux.git
<span class="token function">sudo</span> <span class="token function">mv</span> encrypted-arch-linux /data/http/
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h6 heading-wrapper"><h6 data-heading="Enable Nginx" dir="auto" class="heading" id="Enable_Nginx"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Enable Nginx</h6><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> nginx <span class="token parameter variable">--now</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="done" class="callout drop-shadow"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg></div><div class="callout-title-inner">GG</div></div><div class="callout-content">
<p dir="auto">You can reboot your system and have fun ! GG, now you have an hardened arch linux web-server, with manual install and an http partition that is automatically mounted when the local administrator logged in. This is an advanced configuration, if your setup work, you can be proud of you !</p>
</div></div></div><div class="el-hr"><hr></div><div class="mod-footer mod-ui"></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#ARCH LINUX - Manual Install and Hardening"><div class="tree-item-contents heading-link" heading-name="ARCH LINUX - Manual Install and Hardening"><span class="tree-item-title">ARCH LINUX - Manual Install and Hardening</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Prerequisites"><div class="tree-item-contents heading-link" heading-name="Prerequisites"><span class="tree-item-title">Prerequisites</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Installation_Procedure"><div class="tree-item-contents heading-link" heading-name="Installation Procedure"><span class="tree-item-title">Installation Procedure</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Initial_Setup"><div class="tree-item-contents heading-link" heading-name="Initial Setup"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Initial Setup</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Storage_Configuration_with_Encryption"><div class="tree-item-contents heading-link" heading-name="Storage Configuration with Encryption"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Storage Configuration with Encryption</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#View_current_disk_layout:"><div class="tree-item-contents heading-link" heading-name="View current disk layout:"><span class="tree-item-title">View current disk layout:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Create_partitions"><div class="tree-item-contents heading-link" heading-name="Create partitions"><span class="tree-item-title">Create partitions</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Format_and_encrypt_your_partition"><div class="tree-item-contents heading-link" heading-name="Format and encrypt your partition"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Format and encrypt your partition</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Format_your_EFI_partition"><div class="tree-item-contents heading-link" heading-name="Format your EFI partition"><span class="tree-item-title">Format your EFI partition</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Encrypt_the_main_partition"><div class="tree-item-contents heading-link" heading-name="Encrypt the main partition"><span class="tree-item-title">Encrypt the main partition</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Open_the_encrypted_container"><div class="tree-item-contents heading-link" heading-name="Open the encrypted container"><span class="tree-item-title">Open the encrypted container</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Create_a_physical_volume"><div class="tree-item-contents heading-link" heading-name="Create a physical volume"><span class="tree-item-title">Create a physical volume</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Create_a_volume_group_(vg0)"><div class="tree-item-contents heading-link" heading-name="Create a volume group (vg0)"><span class="tree-item-title">Create a volume group (vg0)</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Create_logical_volumes_for_each_partition"><div class="tree-item-contents heading-link" heading-name="Create logical volumes for each partition"><span class="tree-item-title">Create logical volumes for each partition</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Optional:_create_a_swap_partition_if_needed"><div class="tree-item-contents heading-link" heading-name="Optional: create a swap partition if needed"><span class="tree-item-title">Optional: create a swap partition if needed</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Format_the_partitions"><div class="tree-item-contents heading-link" heading-name="Format the partitions"><span class="tree-item-title">Format the partitions</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#If_you_created_a_swap_partition"><div class="tree-item-contents heading-link" heading-name="If you created a swap partition"><span class="tree-item-title">If you created a swap partition</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Mount_your_partitions"><div class="tree-item-contents heading-link" heading-name="Mount your partitions"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Mount your partitions</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Mount_the_root_filesystem"><div class="tree-item-contents heading-link" heading-name="Mount the root filesystem"><span class="tree-item-title">Mount the root filesystem</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="5"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Create_directories_for_other_mount_points"><div class="tree-item-contents heading-link" heading-name="Create directories for other mount points"><span class="tree-item-title">Create directories for other mount points</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Mount_the_boot_partition"><div class="tree-item-contents heading-link" heading-name="Mount the boot partition"><span class="tree-item-title">Mount the boot partition</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Mount_other_partitions"><div class="tree-item-contents heading-link" heading-name="Mount other partitions"><span class="tree-item-title">Mount other partitions</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#If_you_created_a_swap_partition"><div class="tree-item-contents heading-link" heading-name="If you created a swap partition"><span class="tree-item-title">If you created a swap partition</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#!!!_HARDENING_PARTITION_OPTIONS_!!!"><div class="tree-item-contents heading-link" heading-name="!!! HARDENING PARTITION OPTIONS !!!"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">!!! HARDENING PARTITION OPTIONS !!!</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#When_mounting_the_partition"><div class="tree-item-contents heading-link" heading-name="When mounting the partition"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">When mounting the partition</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Mount_the_boot_partition_with_options"><div class="tree-item-contents heading-link" heading-name="Mount the boot partition with options"><span class="tree-item-title">Mount the boot partition with options</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Mount_other_partitions_with_options"><div class="tree-item-contents heading-link" heading-name="Mount other partitions with options"><span class="tree-item-title">Mount other partitions with options</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Install_base_packages"><div class="tree-item-contents heading-link" heading-name="Install base packages"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Install base packages</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#check_the_fstab_config"><div class="tree-item-contents heading-link" heading-name="check the fstab config"><span class="tree-item-title">check the fstab config</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#if_all_look_good_you_can_put_it_in_the_fstab_of_your_system"><div class="tree-item-contents heading-link" heading-name="if all look good you can put it in the fstab of your system"><span class="tree-item-title">if all look good you can put it in the fstab of your system</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Then_go_to_your_system"><div class="tree-item-contents heading-link" heading-name="Then go to your system"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Then go to your system</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Configure_mkinitcpio.conf_to_include_the_necessary_hooks"><div class="tree-item-contents heading-link" heading-name="Configure mkinitcpio.conf to include the necessary hooks"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Configure mkinitcpio.conf to include the necessary hooks</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Then_regenerate_the_initramfs:"><div class="tree-item-contents heading-link" heading-name="Then regenerate the initramfs:"><span class="tree-item-title">Then regenerate the initramfs:</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Configure_your_system"><div class="tree-item-contents heading-link" heading-name="Configure your system"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Configure your system</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Set_the_timezone"><div class="tree-item-contents heading-link" heading-name="Set the timezone"><span class="tree-item-title">Set the timezone</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Sync_the_hardware_clock"><div class="tree-item-contents heading-link" heading-name="Sync the hardware clock"><span class="tree-item-title">Sync the hardware clock</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Then_we_need_to_change_the_local"><div class="tree-item-contents heading-link" heading-name="Then we need to change the local"><span class="tree-item-title">Then we need to change the local</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Now_we_can_generate_the_locale"><div class="tree-item-contents heading-link" heading-name="Now we can generate the locale"><span class="tree-item-title">Now we can generate the locale</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#We_need_to_generate_the_locale_in_locale.conf_too_because_some_application_can_look_there_instead"><div class="tree-item-contents heading-link" heading-name="We need to generate the locale in locale.conf too because some application can look there instead"><span class="tree-item-title">We need to generate the locale in locale.conf too because some application can look there instead</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Then_we_need_to_give_our_machine_an_awesome_host-name"><div class="tree-item-contents heading-link" heading-name="Then we need to give our machine an awesome host-name"><span class="tree-item-title">Then we need to give our machine an awesome host-name</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Set_the_password_for_the_root_user"><div class="tree-item-contents heading-link" heading-name="Set the password for the root user"><span class="tree-item-title">Set the password for the root user</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Now_we_can_add_a_user,_in_our_case_localadm"><div class="tree-item-contents heading-link" heading-name="Now we can add a user, in our case localadm"><span class="tree-item-title">Now we can add a user, in our case localadm</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Add_a_password_to_our_new_user"><div class="tree-item-contents heading-link" heading-name="Add a password to our new user"><span class="tree-item-title">Add a password to our new user</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Then_we_can_edit_the_visudo_file"><div class="tree-item-contents heading-link" heading-name="Then we can edit the visudo file"><span class="tree-item-title">Then we can edit the visudo file</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Now_we_will_install_grub_to_our_system"><div class="tree-item-contents heading-link" heading-name="Now we will install grub to our system"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Now we will install grub to our system</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="4"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Now_we_need_to_change_the_grub_config_to_allow_grub_to_boot_with_encrypted_device"><div class="tree-item-contents heading-link" heading-name="Now we need to change the grub config to allow grub to boot with encrypted device"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Now we need to change the grub config to allow grub to boot with encrypted device</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Then_we_need_to_go_to_the_config_file_and_put_it_to_the_right_place"><div class="tree-item-contents heading-link" heading-name="Then we need to go to the config file and put it to the right place"><span class="tree-item-title">Then we need to go to the config file and put it to the right place</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="4"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Finally_we_can_generate_the_GRUB_configuration_file"><div class="tree-item-contents heading-link" heading-name="Finally we can generate the GRUB configuration file"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Finally we can generate the GRUB configuration file</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Then_we_can_do_a_QOL_by_enableling_the_networkmanager_to_have_an_ip_add_on_boot"><div class="tree-item-contents heading-link" heading-name="Then we can do a QOL by enableling the networkmanager to have an ip add on boot"><span class="tree-item-title">Then we can do a QOL by enableling the networkmanager to have an ip add on boot</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Finally_we_can_umount_all_and_reboot_our_system"><div class="tree-item-contents heading-link" heading-name="Finally we can umount all and reboot our system"><span class="tree-item-title">Finally we can umount all and reboot our system</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#!!!HARDENING_PARTITION_OPTIONS!!!"><div class="tree-item-contents heading-link" heading-name="!!!HARDENING PARTITION OPTIONS!!!"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">!!!HARDENING PARTITION OPTIONS!!!</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#IF_NOT_DONE_BEFORE,_YOU_CAN_DO_IT_AFTER_THE_REBOOT_OF_YOUR_SYSTEM"><div class="tree-item-contents heading-link" heading-name="IF NOT DONE BEFORE, YOU CAN DO IT AFTER THE REBOOT OF YOUR SYSTEM"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">IF NOT DONE BEFORE, YOU CAN DO IT AFTER THE REBOOT OF YOUR SYSTEM</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Then_you_can_reboot_to_apply_the_change_!"><div class="tree-item-contents heading-link" heading-name="Then you can reboot to apply the change !"><span class="tree-item-title">Then you can reboot to apply the change !</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Hardening_the_System"><div class="tree-item-contents heading-link" heading-name="Hardening the System"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Hardening the System</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Configure_Logs_for_Sudo"><div class="tree-item-contents heading-link" heading-name="Configure Logs for Sudo"><span class="tree-item-title">Configure Logs for Sudo</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Disable_the_Root_User"><div class="tree-item-contents heading-link" heading-name="Disable the Root User"><span class="tree-item-title">Disable the Root User</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#edit_/etc/passwd"><div class="tree-item-contents heading-link" heading-name="edit /etc/passwd"><span class="tree-item-title">edit /etc/passwd</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Edit_`/etc/shadow`_:"><div class="tree-item-contents heading-link" heading-name="Edit `/etc/shadow` :"><span class="tree-item-title">Edit <code>/etc/shadow</code> :</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Add_Security_Options"><div class="tree-item-contents heading-link" heading-name="Add Security Options"><span class="tree-item-title">Add Security Options</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Edit_/etc/fstab"><div class="tree-item-contents heading-link" heading-name="Edit /etc/fstab"><span class="tree-item-title">Edit /etc/fstab</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#SSH_Server:_Setup,_Configuration_and_Hardening"><div class="tree-item-contents heading-link" heading-name="SSH Server: Setup, Configuration and Hardening"><span class="tree-item-title">SSH Server: Setup, Configuration and Hardening</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Basic_Setup"><div class="tree-item-contents heading-link" heading-name="Basic Setup"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Basic Setup</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Install_Required_Packages"><div class="tree-item-contents heading-link" heading-name="Install Required Packages"><span class="tree-item-title">Install Required Packages</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Configure_SSH_Service"><div class="tree-item-contents heading-link" heading-name="Configure SSH Service"><span class="tree-item-title">Configure SSH Service</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Hardening_SSH_Configuration"><div class="tree-item-contents heading-link" heading-name="Hardening SSH Configuration"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Hardening SSH Configuration</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Modify_SSH_Port"><div class="tree-item-contents heading-link" heading-name="Modify SSH Port"><span class="tree-item-title">Modify SSH Port</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Disable_Root_Login"><div class="tree-item-contents heading-link" heading-name="Disable Root Login"><span class="tree-item-title">Disable Root Login</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Apply_Changes"><div class="tree-item-contents heading-link" heading-name="Apply Changes"><span class="tree-item-title">Apply Changes</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Connect_to_SSH"><div class="tree-item-contents heading-link" heading-name="Connect to SSH"><span class="tree-item-title">Connect to SSH</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#RSA_Key_Authentication"><div class="tree-item-contents heading-link" heading-name="RSA Key Authentication"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">RSA Key Authentication</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Generate_SSH_Key_Pair_on_Server"><div class="tree-item-contents heading-link" heading-name="Generate SSH Key Pair on Server"><span class="tree-item-title">Generate SSH Key Pair on Server</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Transfer_Private_Key_to_Client"><div class="tree-item-contents heading-link" heading-name="Transfer Private Key to Client"><span class="tree-item-title">Transfer Private Key to Client</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Enable_Authorized_Keys_File"><div class="tree-item-contents heading-link" heading-name="Enable Authorized Keys File"><span class="tree-item-title">Enable Authorized Keys File</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Apply_Changes"><div class="tree-item-contents heading-link" heading-name="Apply Changes"><span class="tree-item-title">Apply Changes</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Two-Factor_Authentication_(2FA)"><div class="tree-item-contents heading-link" heading-name="Two-Factor Authentication (2FA)"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Two-Factor Authentication (2FA)</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Install_and_Configure_Google_Authenticator"><div class="tree-item-contents heading-link" heading-name="Install and Configure Google Authenticator"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Install and Configure Google Authenticator</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="4"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Set_up_correct_time_zone"><div class="tree-item-contents heading-link" heading-name="Set up correct time zone"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Set up correct time zone</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Check_your_date"><div class="tree-item-contents heading-link" heading-name="Check your date"><span class="tree-item-title">Check your date</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#If_it's_the_good_date_and_hour,_you_can_proceed,_else_you_need_to_set_the_good_time/date:"><div class="tree-item-contents heading-link" heading-name="If it's the good date and hour, you can proceed, else you need to set the good time/date:"><span class="tree-item-title">If it's the good date and hour, you can proceed, else you need to set the good time/date:</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Configure_PAM_for_SSH_2FA"><div class="tree-item-contents heading-link" heading-name="Configure PAM for SSH 2FA"><span class="tree-item-title">Configure PAM for SSH 2FA</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Configure_SSH_to_Use_PAM"><div class="tree-item-contents heading-link" heading-name="Configure SSH to Use PAM"><span class="tree-item-title">Configure SSH to Use PAM</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Apply_Changes"><div class="tree-item-contents heading-link" heading-name="Apply Changes"><span class="tree-item-title">Apply Changes</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Access_Control"><div class="tree-item-contents heading-link" heading-name="Access Control"><span class="tree-item-title">Access Control</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Prevent_Empty_Passwords"><div class="tree-item-contents heading-link" heading-name="Prevent Empty Passwords"><span class="tree-item-title">Prevent Empty Passwords</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Idle_Timeout_Interval"><div class="tree-item-contents heading-link" heading-name="Idle Timeout Interval"><span class="tree-item-title">Idle Timeout Interval</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#X11_Forwarding"><div class="tree-item-contents heading-link" heading-name="X11 Forwarding"><span class="tree-item-title">X11 Forwarding</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Agent_and_TCP_Forwarding"><div class="tree-item-contents heading-link" heading-name="Agent and TCP Forwarding"><span class="tree-item-title">Agent and TCP Forwarding</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Password_Authentication"><div class="tree-item-contents heading-link" heading-name="Password Authentication"><span class="tree-item-title">Password Authentication</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Reloading_SSH"><div class="tree-item-contents heading-link" heading-name="Reloading SSH"><span class="tree-item-title">Reloading SSH</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Harden_network_and_Kernel_with_sysctl_settings"><div class="tree-item-contents heading-link" heading-name="Harden network and Kernel with sysctl settings"><span class="tree-item-title">Harden network and Kernel with sysctl settings</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Network_Protection_Settings"><div class="tree-item-contents heading-link" heading-name="Network Protection Settings"><span class="tree-item-title">Network Protection Settings</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Kernel_Hardening_Settings"><div class="tree-item-contents heading-link" heading-name="Kernel Hardening Settings"><span class="tree-item-title">Kernel Hardening Settings</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#File_System_and_Memory_Protection"><div class="tree-item-contents heading-link" heading-name="File System and Memory Protection"><span class="tree-item-title">File System and Memory Protection</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Apply_the_sittings"><div class="tree-item-contents heading-link" heading-name="Apply the sittings"><span class="tree-item-title">Apply the sittings</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Verifying_the_Settings"><div class="tree-item-contents heading-link" heading-name="Verifying the Settings"><span class="tree-item-title">Verifying the Settings</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Setting_Up_a_Firewall_using_UFW"><div class="tree-item-contents heading-link" heading-name="Setting Up a Firewall using UFW"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Setting Up a Firewall using UFW</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Installing_UFW:"><div class="tree-item-contents heading-link" heading-name="Installing UFW:"><span class="tree-item-title">Installing UFW:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#UFW's_Default_Policy"><div class="tree-item-contents heading-link" heading-name="UFW's Default Policy"><span class="tree-item-title">UFW's Default Policy</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#UFW's_Configuration_Files"><div class="tree-item-contents heading-link" heading-name="UFW's Configuration Files"><span class="tree-item-title">UFW's Configuration Files</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#UFW's_Rules_Files"><div class="tree-item-contents heading-link" heading-name="UFW's Rules Files"><span class="tree-item-title">UFW's Rules Files</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Basic_User-Defined_Rules"><div class="tree-item-contents heading-link" heading-name="Basic User-Defined Rules"><span class="tree-item-title">Basic User-Defined Rules</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Allowing_and_Denying_Traffic"><div class="tree-item-contents heading-link" heading-name="Allowing and Denying Traffic"><span class="tree-item-title">Allowing and Denying Traffic</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Application_Profiles"><div class="tree-item-contents heading-link" heading-name="Application Profiles"><span class="tree-item-title">Application Profiles</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#The_`Limit`_Rule"><div class="tree-item-contents heading-link" heading-name="The `Limit` Rule"><span class="tree-item-title">The <code>Limit</code> Rule</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Access_Control_by_IP_or_Subnet"><div class="tree-item-contents heading-link" heading-name="Access Control by IP or Subnet"><span class="tree-item-title">Access Control by IP or Subnet</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Enabling_and_Checking_Status"><div class="tree-item-contents heading-link" heading-name="Enabling and Checking Status"><span class="tree-item-title">Enabling and Checking Status</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Deleting_Rules"><div class="tree-item-contents heading-link" heading-name="Deleting Rules"><span class="tree-item-title">Deleting Rules</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Best_Practices"><div class="tree-item-contents heading-link" heading-name="Best Practices"><span class="tree-item-title">Best Practices</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Advanced_Firewall_Rules"><div class="tree-item-contents heading-link" heading-name="Advanced Firewall Rules"><span class="tree-item-title">Advanced Firewall Rules</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Structure_of_`before.rules`_Files"><div class="tree-item-contents heading-link" heading-name="Structure of `before.rules` Files"><span class="tree-item-title">Structure of <code>before.rules</code> Files</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Use_Case"><div class="tree-item-contents heading-link" heading-name="Use Case"><span class="tree-item-title">Use Case</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Example_of_Advanced_Rules"><div class="tree-item-contents heading-link" heading-name="Example of Advanced Rules"><span class="tree-item-title">Example of Advanced Rules</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#IF_YOU_ARE_MAKING_THE_REVERSE_PROXY_YOU_NEED_TO_DO_THESES_STEP_BELLOW."><div class="tree-item-contents heading-link" heading-name="IF YOU ARE MAKING THE REVERSE PROXY YOU NEED TO DO THESES STEP BELLOW."><span class="tree-item-title">IF YOU ARE MAKING THE REVERSE PROXY YOU NEED TO DO THESES STEP BELLOW.</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Installing_and_configuring_Fail2Ban"><div class="tree-item-contents heading-link" heading-name="Installing and configuring Fail2Ban"><span class="tree-item-title">Installing and configuring Fail2Ban</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Pre-Configuration"><div class="tree-item-contents heading-link" heading-name="Pre-Configuration"><span class="tree-item-title">Pre-Configuration</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Configuration"><div class="tree-item-contents heading-link" heading-name="Configuration"><span class="tree-item-title">Configuration</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Email_Alerts"><div class="tree-item-contents heading-link" heading-name="Email Alerts"><span class="tree-item-title">Email Alerts</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Default_Action"><div class="tree-item-contents heading-link" heading-name="Default Action"><span class="tree-item-title">Default Action</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Individual_Jails"><div class="tree-item-contents heading-link" heading-name="Individual Jails"><span class="tree-item-title">Individual Jails</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Starting_Fail2ban"><div class="tree-item-contents heading-link" heading-name="Starting Fail2ban"><span class="tree-item-title">Starting Fail2ban</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#IF_YOU_ARE_MAKING_THE_WEB_SERVER_AND_NOT_THE_REVERSE_PROXY_YOU_NEED_TO_DO_THESES_STEP_BELLOW_during_the_base_install_of_your_arch-linux"><div class="tree-item-contents heading-link" heading-name="IF YOU ARE MAKING THE WEB SERVER AND NOT THE REVERSE PROXY YOU NEED TO DO THESES STEP BELLOW during the base install of your arch-linux"><span class="tree-item-title">IF YOU ARE MAKING THE WEB SERVER AND NOT THE REVERSE PROXY YOU NEED TO DO THESES STEP BELLOW during the base install of your arch-linux</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Now_we_will_crypt_the_http_partition_onto_the_/data_for_the_web-server"><div class="tree-item-contents heading-link" heading-name="Now we will crypt the http partition onto the /data for the web-server"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Now we will crypt the http partition onto the /data for the web-server</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Create_a_new_logical_volume"><div class="tree-item-contents heading-link" heading-name="Create a new logical volume"><span class="tree-item-title">Create a new logical volume</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Encrypt_it_separately"><div class="tree-item-contents heading-link" heading-name="Encrypt it separately"><span class="tree-item-title">Encrypt it separately</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Open_the_volume"><div class="tree-item-contents heading-link" heading-name="Open the volume"><span class="tree-item-title">Open the volume</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Format_the_partition"><div class="tree-item-contents heading-link" heading-name="Format the partition"><span class="tree-item-title">Format the partition</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Mount_the_partition"><div class="tree-item-contents heading-link" heading-name="Mount the partition"><span class="tree-item-title">Mount the partition</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Then_you_can_umount_and_reboot"><div class="tree-item-contents heading-link" heading-name="Then you can umount and reboot"><span class="tree-item-title">Then you can umount and reboot</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#IN_YOUR_RUNNIG_ARCH_LINUX_MACHINE_AFTER_REBOOTING"><div class="tree-item-contents heading-link" heading-name="IN YOUR RUNNIG ARCH LINUX MACHINE AFTER REBOOTING"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">IN YOUR RUNNIG ARCH LINUX MACHINE AFTER REBOOTING</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="4"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Create_the_script_that_mount_the_encrypted_http_partition"><div class="tree-item-contents heading-link" heading-name="Create the script that mount the encrypted http partition"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Create the script that mount the encrypted http partition</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Then_we_need_to_make_this_script_executable:"><div class="tree-item-contents heading-link" heading-name="Then we need to make this script executable:"><span class="tree-item-title">Then we need to make this script executable:</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="4"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Install_and_configure_Nginx"><div class="tree-item-contents heading-link" heading-name="Install and configure Nginx"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Install and configure Nginx</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Install_nginx"><div class="tree-item-contents heading-link" heading-name="Install nginx"><span class="tree-item-title">Install nginx</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Create_a_maintenance_page"><div class="tree-item-contents heading-link" heading-name="Create a maintenance page"><span class="tree-item-title">Create a maintenance page</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Configure_Nginx"><div class="tree-item-contents heading-link" heading-name="Configure Nginx"><span class="tree-item-title">Configure Nginx</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Then_create_an_index.html_file_for_your_main_website"><div class="tree-item-contents heading-link" heading-name="Then create an index.html file for your main website"><span class="tree-item-title">Then create an index.html file for your main website</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="6"><a class="tree-link" href="arch-linux-manual-install-and-hardening.html#Enable_Nginx"><div class="tree-item-contents heading-link" heading-name="Enable Nginx"><span class="tree-item-title">Enable Nginx</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>